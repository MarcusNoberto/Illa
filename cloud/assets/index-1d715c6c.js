import{k as t,q as c,l as D,a9 as L,B as U,aq as w,F as f,ax as W}from"./@illa-design-df878cb8.js";import{F as B,a1 as F,ay as j}from"./index-e60a5063.js";import{T as M}from"./index-1e58851c.js";import{r as v}from"./react-bc846394.js";import{u as A,c as G,C as d,g as K,l as O,b as $,h as z,d as H,f as J,e as y,a as P}from"./style-99767516.js";import{R as Q,v as g,u as X,i as Y}from"./index-ea53e05a.js";import{R as Z}from"./index-7404e1b7.js";import{T as R}from"./Trans-d2ecd627.js";import"./@emotion-28b7fe46.js";import"./index-6c246049.js";import"./hook-51175b2f.js";import"./index-b4d4a84a.js";import"./interface-8df5fe4c.js";import"./utils-ed900d7c.js";import"./style-56e482f1.js";import"./upstash-7245fd7f.js";import"./index-5eb33cbd.js";import"./index.esm-11ba4214.js";import"./lodash-lib-cfb0e9ed.js";const ee="5432",x=a=>{const n=/^(.*):\/\/(.*):(.*)@(.*?)(?::(\d+))?\/(.*)$/,e=a.match(n);return e?{roleName:e[2]||null,password:e[3]||null,hostWithoutPort:e[4]||null,dbName:e[6]||null}:{roleName:null,password:null,hostWithoutPort:null,dbName:null}},te=a=>{if(!a)return"";const n="editor.action.form.tips.neon.failed";if(!/^postgres:/i.test(a))return n;const{roleName:r,dbName:p,hostWithoutPort:s,password:u}=x(a);return r===null||s===null||s&&!j(s)||p===null?n:u===null?"editor.action.form.tips.neon.no_password":""},oe=a=>{const{resourceID:n}=a,{t:e}=B(),{control:r,reset:p,getValues:s,formState:u,watch:C}=A(),{getResourceByID:T}=v.useContext(Q),o=T(n),S=C("host"),m=C("connectionString"),N=Y(S??""),l=te(m),V=i=>()=>window.open(i,"_blank"),I=v.useCallback(()=>{const i=x(m),{resourceName:h}=s(),{roleName:b,password:k,hostWithoutPort:q,dbName:E}=i;p({resourceName:h,connectionString:"",host:q??"",databaseName:E,databaseUsername:b,databasePassword:k})},[m,p,s]),_=()=>t(R,{i18nKey:"editor.action.form.tips.neon.normal",t:e,components:[t(M,{onClick:V("https://console.neon.tech/app/projects/")},"editor.action.form.tips.neon.normal")]});return t(f,{children:c("div",{css:G,children:[t(d,{controlledType:"input",isRequired:!0,title:e("editor.action.resource.db.label.name"),control:r,defaultValue:(o==null?void 0:o.resourceName)??"",rules:[{validate:g}],placeholders:[e("editor.action.resource.db.placeholder.name")],name:"resourceName",tips:e("editor.action.resource.restapi.tip.name")}),t(Z,{type:"General Option"}),c("div",{css:K,children:[t("div",{css:O,children:t("span",{css:$(D("grayBlue","02")),children:e("editor.action.form.option.neon.connection_string")})}),c("div",{css:z,children:[t(H,{control:r,defaultValue:"",rules:{validate:()=>!l},render:({field:{value:i,onChange:h,onBlur:b}})=>t(L,{w:"100%",onBlur:b,onChange:h,error:!!l,value:i,colorScheme:"techPurple",placeholder:"postgres://testUser:abcdefg@ep-restless-rice-862380.us-east-2.aws.neon.tech/neondb"}),name:"connectionString"}),t(U,{disabled:!!l||!m,onClick:I,colorScheme:"techPurple",h:"32px",children:e("editor.action.form.option.neon.parse")})]})]}),t("div",{css:J,children:l?c("div",{css:y,children:[t(w,{css:P}),t(f,{children:e(l)})]}):t("div",{children:t(_,{})})}),t(d,{title:e("editor.action.resource.db.label.hostname_port"),defaultValue:[o==null?void 0:o.content.host,+((o==null?void 0:o.content.port)??ee)],name:["host","port"],controlledType:["input","number"],control:r,isRequired:!0,rules:[{validate:X},{required:!0}],styles:[{flex:4},{flex:1}],placeholders:[e("editor.action.resource.db.placeholder.hostname")],tips:u.errors.host&&!N?c("div",{css:y,children:[t(w,{css:P}),t(f,{children:u.errors.host.message})]}):null}),N&&t(d,{defaultValue:"",name:"",title:"",controlledType:"none",control:r,tips:t(W,{title:e("editor.action.form.tips.connect_to_local.title.tips"),closable:!1,content:e("editor.action.form.tips.connect_to_local.selfhost")})}),t(d,{title:e("editor.action.resource.db.label.database"),defaultValue:o==null?void 0:o.content.databaseName,name:"databaseName",controlledType:"input",control:r,isRequired:!0,rules:[{validate:g}],placeholders:[e("editor.action.resource.db.placeholder.database")]}),t(d,{title:e("editor.action.resource.db.label.username_password"),defaultValue:[o==null?void 0:o.content.databaseUsername,o==null?void 0:o.content.databasePassword],name:["databaseUsername","databasePassword"],controlledType:["input","password"],control:r,isRequired:!0,rules:[{validate:g},{required:!0}],placeholders:[e("editor.action.resource.db.placeholder.username"),e("editor.action.resource.db.placeholder.password")]}),F]})})};oe.displayName="NeonConfigElement";export{oe as default};
//# sourceMappingURL=index-1d715c6c.js.map
