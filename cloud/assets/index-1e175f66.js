import{j as t,n as c,h as D,a6 as L,B as U,an as w,F as f,au as W}from"./@illa-design-764f0835.js";import{F as j,Z as B,au as F}from"./index-7f07a8bc.js";import{T as M}from"./index-eab177f8.js";import{r as v}from"./react-bc846394.js";import{u as A,c as G,C as d,g as K,l as O,b as Z,h as $,d as z,f as H,e as y,a as P}from"./style-3f22391e.js";import{R as J,v as g,u as Q,i as X}from"./index-c457e5cc.js";import{R as Y}from"./index-dc588a24.js";import{T as R}from"./Trans-a7ca814a.js";import"./@emotion-09d14760.js";import"./index-7e6ea323.js";import"./hook-9ce46d5a.js";import"./index-0961fa5d.js";import"./interface-8df5fe4c.js";import"./utils-7f5e5ff5.js";import"./style-00a92373.js";import"./upstash-e9b235a2.js";import"./index-4370180f.js";import"./index.esm-11ba4214.js";import"./lodash-lib-cfb0e9ed.js";const ee="5432",x=n=>{const a=/^(.*):\/\/(.*):(.*)@(.*?)(?::(\d+))?\/(.*)$/,e=n.match(a);return e?{roleName:e[2]||null,password:e[3]||null,hostWithoutPort:e[4]||null,dbName:e[6]||null}:{roleName:null,password:null,hostWithoutPort:null,dbName:null}},te=n=>{if(!n)return"";const a="editor.action.form.tips.neon.failed";if(!/^postgres:/i.test(n))return a;const{roleName:r,dbName:u,hostWithoutPort:s,password:p}=x(n);return r===null||s===null||s&&!F(s)||u===null?a:p===null?"editor.action.form.tips.neon.no_password":""},oe=n=>{const{resourceID:a}=n,{t:e}=j(),{control:r,reset:u,getValues:s,formState:p,watch:C}=A(),{getResourceByID:T}=v.useContext(J),o=T(a),S=C("host"),m=C("connectionString"),N=X(S??""),l=te(m),V=i=>()=>window.open(i,"_blank"),I=v.useCallback(()=>{const i=x(m),{resourceName:h}=s(),{roleName:b,password:k,hostWithoutPort:q,dbName:E}=i;u({resourceName:h,connectionString:"",host:q??"",databaseName:E,databaseUsername:b,databasePassword:k})},[m,u,s]),_=()=>t(R,{i18nKey:"editor.action.form.tips.neon.normal",t:e,components:[t(M,{onClick:V("https://console.neon.tech/app/projects/")},"editor.action.form.tips.neon.normal")]});return t(f,{children:c("div",{css:G,children:[t(d,{controlledType:"input",isRequired:!0,title:e("editor.action.resource.db.label.name"),control:r,defaultValue:(o==null?void 0:o.resourceName)??"",rules:[{validate:g}],placeholders:[e("editor.action.resource.db.placeholder.name")],name:"resourceName",tips:e("editor.action.resource.restapi.tip.name")}),t(Y,{type:"General Option"}),c("div",{css:K,children:[t("div",{css:O,children:t("span",{css:Z(D("grayBlue","02")),children:e("editor.action.form.option.neon.connection_string")})}),c("div",{css:$,children:[t(z,{control:r,defaultValue:"",rules:{validate:()=>!l},render:({field:{value:i,onChange:h,onBlur:b}})=>t(L,{w:"100%",onBlur:b,onChange:h,error:!!l,value:i,colorScheme:"techPurple",placeholder:"postgres://testUser:abcdefg@ep-restless-rice-862380.us-east-2.aws.neon.tech/neondb"}),name:"connectionString"}),t(U,{disabled:!!l||!m,onClick:I,colorScheme:"techPurple",h:"32px",children:e("editor.action.form.option.neon.parse")})]})]}),t("div",{css:H,children:l?c("div",{css:y,children:[t(w,{css:P}),t(f,{children:e(l)})]}):t("div",{children:t(_,{})})}),t(d,{title:e("editor.action.resource.db.label.hostname_port"),defaultValue:[o==null?void 0:o.content.host,+((o==null?void 0:o.content.port)??ee)],name:["host","port"],controlledType:["input","number"],control:r,isRequired:!0,rules:[{validate:Q},{required:!0}],styles:[{flex:4},{flex:1}],placeholders:[e("editor.action.resource.db.placeholder.hostname")],tips:p.errors.host&&!N?c("div",{css:y,children:[t(w,{css:P}),t(f,{children:p.errors.host.message})]}):null}),N&&t(d,{defaultValue:"",name:"",title:"",controlledType:"none",control:r,tips:t(W,{title:e("editor.action.form.tips.connect_to_local.title.tips"),closable:!1,content:e("editor.action.form.tips.connect_to_local.selfhost")})}),t(d,{title:e("editor.action.resource.db.label.database"),defaultValue:o==null?void 0:o.content.databaseName,name:"databaseName",controlledType:"input",control:r,isRequired:!0,rules:[{validate:g}],placeholders:[e("editor.action.resource.db.placeholder.database")]}),t(d,{title:e("editor.action.resource.db.label.username_password"),defaultValue:[o==null?void 0:o.content.databaseUsername,o==null?void 0:o.content.databasePassword],name:["databaseUsername","databasePassword"],controlledType:["input","password"],control:r,isRequired:!0,rules:[{validate:g},{required:!0}],placeholders:[e("editor.action.resource.db.placeholder.username"),e("editor.action.resource.db.placeholder.password")]}),B]})})};oe.displayName="NeonConfigElement";export{oe as default};
//# sourceMappingURL=index-1e175f66.js.map
