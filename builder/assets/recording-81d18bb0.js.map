{"version":3,"file":"recording-81d18bb0.js","sources":["../../src/widgetLibrary/RecordingWidget/style.ts","../../src/widgetLibrary/RecordingWidget/utils.ts","../../src/widgetLibrary/RecordingWidget/useHandleRecord.ts","../../src/widgetLibrary/RecordingWidget/baseRecord.tsx","../../src/widgetLibrary/RecordingWidget/recording.tsx"],"sourcesContent":["import { css } from \"@emotion/react\"\n\nexport const applyPreviewStyle = css`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 15px;\n  height: 100%;\n  width: 100%;\n`\n\nexport const audioContainerStyle = css`\n  width: 100%;\n  height: 45px;\n`\n\nexport const applyContainerStyle = css`\n  flex-direction: row;\n  align-items: center;\n  gap: 15px;\n  height: 100%;\n  width: 100%;\n  box-sizing: border-box;\n`\n\nexport const applyTextButtonStyle = css`\n  &:hover,\n  &:active {\n    background-color: transparent !important;\n  }\n`\n","type TimerId = ReturnType<typeof setTimeout>\nexport const setInternalByTimeout = (\n  callback: () => void,\n  interval: number,\n) => {\n  let startTime = Date.now()\n  let timerId: TimerId\n  const deviation = 50\n  function run() {\n    const expected = startTime + interval\n    const drift = Date.now() - expected\n    if (drift > deviation) {\n      startTime = Date.now() + drift\n    } else {\n      startTime += interval\n    }\n    callback()\n    timerId = setTimeout(run, Math.max(0, interval - drift))\n  }\n  timerId = setTimeout(run, interval)\n  return () => {\n    clearTimeout(timerId)\n  }\n}\n\nexport const getsSafeNodeValue = (val: unknown) => {\n  return typeof val === \"string\" ? val : \"\"\n}\n\nexport const getDataFromVal = (val: unknown) => {\n  const rep = /^data:audio[^,]+base64,/\n  if (typeof val !== \"string\" || !val || !rep.test(val)) {\n    return \"\"\n  } else {\n    return val.replace(rep, \"\")\n  }\n}\n","import { useCallback, useEffect, useRef, useState } from \"react\"\nimport { setInternalByTimeout } from \"./utils\"\n\nexport const useHandleRecord = (\n  handleUpdateStatus: (value: Record<string, any>) => void,\n  handleOnChange: ((value: string) => void) | undefined,\n) => {\n  const [isRecording, setIsRecording] = useState<boolean>(false)\n  const startTime = useRef<number | undefined>()\n  const [recordingTime, setRecordingTime] = useState<number>(0)\n  const cancelTimer = useRef<() => void>()\n  const chunks = useRef<Blob[]>([])\n  const recorder = useRef<MediaRecorder | null>(null)\n  const stream = useRef<MediaStream | null>(null)\n  const [url, setUrl] = useState<string>()\n  const startRecordFnRef = useRef<() => void>()\n  const dataRecordFnRef = useRef<(e: BlobEvent) => void>()\n  const stopRecordFnRef = useRef<() => void>()\n\n  const handleButtonClick = useCallback(async () => {\n    cancelTimer.current && cancelTimer.current()\n    if (isRecording && recorder.current) {\n      recorder.current.stop()\n      handleUpdateStatus({ recordTime: parseFloat(recordingTime.toFixed(1)) })\n      setIsRecording(false)\n    } else {\n      try {\n        recorder.current = null\n        stream.current = await navigator.mediaDevices.getUserMedia({\n          audio: true,\n        })\n        const currentRecorder = new MediaRecorder(stream.current)\n        startRecordFnRef.current = () => {\n          startTime.current = window.performance.now()\n          cancelTimer.current = setInternalByTimeout(() => {\n            const now = window.performance.now()\n            const value = (now - (startTime.current as number)) / 1000\n            setRecordingTime(value)\n          }, 100)\n        }\n        dataRecordFnRef.current = (e) => {\n          chunks.current.push(e.data)\n        }\n        stopRecordFnRef.current = async () => {\n          if (stream.current) {\n            await stream.current.getTracks().forEach((track) => track.stop())\n          }\n          const audioBlob = new Blob(chunks.current, {\n            type: currentRecorder.mimeType,\n          })\n          const url = URL.createObjectURL(audioBlob)\n          setUrl(url)\n          var reader = new FileReader()\n          reader.onload = function (e) {\n            const data = e.target?.result\n            if (data && typeof data === \"string\") {\n              handleOnChange && handleOnChange(data || \"\")\n            }\n          }\n          reader.readAsDataURL(audioBlob)\n          if (recorder.current) {\n            startRecordFnRef.current &&\n              recorder.current.removeEventListener(\n                \"start\",\n                startRecordFnRef.current,\n              )\n            dataRecordFnRef.current &&\n              recorder.current.removeEventListener(\n                \"dataavailable\",\n                dataRecordFnRef.current,\n              )\n            stopRecordFnRef.current &&\n              recorder.current.removeEventListener(\n                \"stop\",\n                stopRecordFnRef.current,\n              )\n          }\n          stream.current = null\n          recorder.current = null\n        }\n        currentRecorder.addEventListener(\"start\", startRecordFnRef.current)\n\n        currentRecorder.addEventListener(\n          \"dataavailable\",\n          dataRecordFnRef.current,\n        )\n\n        currentRecorder.addEventListener(\"stop\", stopRecordFnRef.current)\n\n        currentRecorder.start()\n        recorder.current = currentRecorder\n        setIsRecording(true)\n      } catch (error) {\n        console.log(error)\n      }\n    }\n  }, [handleOnChange, handleUpdateStatus, isRecording, recordingTime])\n\n  const clearData = () => {\n    chunks.current = []\n    url && URL.revokeObjectURL(url)\n    setUrl(\"\")\n    setRecordingTime(0)\n    handleUpdateStatus({ recordTime: 0 })\n    handleOnChange && handleOnChange(\"\")\n  }\n\n  useEffect(() => {\n    return () => {\n      cancelTimer.current && cancelTimer.current()\n      if (recorder.current && recorder.current.state !== \"inactive\") {\n        recorder.current.stop()\n      }\n      if (stream.current) {\n        stream.current.getTracks()?.forEach((track) => track.stop())\n      }\n    }\n  }, [stream, recorder])\n\n  return {\n    isRecording,\n    url,\n    recordingTime,\n    handleButtonClick,\n    clearData,\n  }\n}\n","import { FC, useEffect, useRef, useState } from \"react\"\nimport { Button } from \"@illa-design/react\"\nimport { WrappedAudio } from \"@/widgetLibrary/AudioWidget/audio\"\nimport {\n  DefaultClearText,\n  DefaultStartText,\n  DefaultStopText,\n  RecordPermission,\n} from \"@/widgetLibrary/RecordingWidget/constants\"\nimport { BaseAudioRecorder } from \"@/widgetLibrary/RecordingWidget/interface\"\nimport {\n  applyContainerStyle,\n  applyPreviewStyle,\n  applyTextButtonStyle,\n  audioContainerStyle,\n} from \"@/widgetLibrary/RecordingWidget/style\"\nimport { useHandleRecord } from \"@/widgetLibrary/RecordingWidget/useHandleRecord\"\nimport { getsSafeNodeValue } from \"@/widgetLibrary/RecordingWidget/utils\"\n\nexport const BaseRecorder: FC<BaseAudioRecorder> = (props) => {\n  const {\n    value,\n    loading = false,\n    disabled = false,\n    startText,\n    stopText,\n    clearText,\n    colorScheme = \"blue\",\n    handleUpdateStatus,\n    handleOnChange,\n  } = props\n  const permissionStatus = useRef<PermissionStatus | null>()\n  const [permissionDisabled, setPermissionDisabled] = useState<boolean>(true)\n\n  const { isRecording, url, recordingTime, handleButtonClick, clearData } =\n    useHandleRecord(handleUpdateStatus, handleOnChange)\n\n  const emptyFun = () => undefined\n\n  useEffect(() => {\n    const handlePermissionChange = (event: Event) => {\n      const result = event.target as PermissionStatus\n      if (result.state === \"granted\" || result.state === \"prompt\") {\n        handleUpdateStatus({ validateMessage: \"\" })\n        setPermissionDisabled(false)\n      } else if (result.state === \"denied\") {\n        handleUpdateStatus({ validateMessage: RecordPermission })\n        setPermissionDisabled(true)\n      }\n    }\n\n    navigator?.permissions\n      ?.query({ name: \"microphone\" as PermissionName })\n      .then((status) => {\n        permissionStatus.current = status\n        if (status.state === \"granted\" || status.state === \"prompt\") {\n          setPermissionDisabled(false)\n        } else if (status.state === \"denied\") {\n          handleUpdateStatus({\n            validateMessage: RecordPermission,\n          })\n          setPermissionDisabled(true)\n        }\n        status.addEventListener(\"change\", handlePermissionChange)\n      })\n\n    return () => {\n      permissionStatus.current?.removeEventListener(\n        \"change\",\n        handlePermissionChange,\n      )\n    }\n  }, [handleUpdateStatus])\n\n  useEffect(() => {\n    handleUpdateStatus({ isRecording })\n  }, [handleUpdateStatus, isRecording])\n\n  return (\n    <div css={applyContainerStyle}>\n      {!url && !value && (\n        <Button\n          onClick={handleButtonClick}\n          disabled={permissionDisabled || disabled}\n          loading={loading}\n          colorScheme={colorScheme}\n          size=\"large\"\n          w=\"100%\"\n        >\n          {!isRecording\n            ? getsSafeNodeValue(startText || DefaultStartText)\n            : `${getsSafeNodeValue(\n                stopText || DefaultStopText,\n              )} ${recordingTime.toFixed(1)}s`}\n        </Button>\n      )}\n      {(url || value) && !isRecording && (\n        <div css={applyPreviewStyle}>\n          <Button\n            onClick={clearData}\n            loading={loading}\n            colorScheme=\"grayBlue\"\n            variant=\"text\"\n            css={applyTextButtonStyle}\n          >\n            {getsSafeNodeValue(clearText || DefaultClearText)}\n          </Button>\n          <div css={audioContainerStyle}>\n            <WrappedAudio\n              {...props}\n              key={url}\n              url={url || value}\n              controls={true}\n              onPlay={emptyFun}\n              onPause={emptyFun}\n              onEnded={emptyFun}\n              onReady={emptyFun}\n              onPlaybackRateChange={emptyFun}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","import { FC, forwardRef, useCallback, useEffect } from \"react\"\nimport { useMessage } from \"@illa-design/react\"\nimport { AutoHeightContainer } from \"@/widgetLibrary/PublicSector/AutoHeightContainer\"\nimport { InvalidMessage } from \"@/widgetLibrary/PublicSector/InvalidMessage\"\nimport { handleValidateCheck } from \"@/widgetLibrary/PublicSector/InvalidMessage/utils\"\nimport { TooltipWrapper } from \"@/widgetLibrary/PublicSector/TooltipWrapper\"\nimport { BaseRecorder } from \"@/widgetLibrary/RecordingWidget/baseRecord\"\nimport {\n  AudioRecorderWidgetProps,\n  WrappedAudioRecorderProps,\n} from \"@/widgetLibrary/RecordingWidget/interface\"\nimport { getDataFromVal } from \"@/widgetLibrary/RecordingWidget/utils\"\n\nexport const WrappedRecording = forwardRef<\n  HTMLDivElement,\n  WrappedAudioRecorderProps\n>((props, ref) => {\n  return (\n    <div ref={ref}>\n      <BaseRecorder {...props} />\n    </div>\n  )\n})\n\nWrappedRecording.displayName = \"WrappedRecording\"\n\nexport const RecordingWidget: FC<AudioRecorderWidgetProps> = (props) => {\n  const {\n    displayName,\n    minDuration,\n    maxDuration,\n    required,\n    value,\n    isRecording,\n    recordTime,\n    tooltipText,\n    customRule,\n    hideValidationMessage,\n    validateMessage,\n    triggerEventHandler,\n    updateComponentHeight,\n    handleUpdateMultiExecutionResult,\n    updateComponentRuntimeProps,\n    deleteComponentRuntimeProps,\n  } = props\n\n  const messageModal = useMessage()\n\n  const getValidateMessage = useCallback(() => {\n    if (!hideValidationMessage) {\n      let message: string | undefined\n      if (value && !recordTime) {\n        message = handleValidateCheck({\n          value,\n          customRule,\n        })\n      } else if (!value && !recordTime) {\n        message = handleValidateCheck({\n          value: undefined,\n          required,\n          customRule,\n        })\n      } else {\n        message = handleValidateCheck({\n          value: recordTime,\n          required,\n          maxDuration: maxDuration ?? 10000,\n          minDuration: minDuration ?? 0,\n          customRule,\n        })\n      }\n      const showMessage = message && message.length > 0\n      return showMessage ? message : \"\"\n    }\n    return \"\"\n  }, [\n    customRule,\n    hideValidationMessage,\n    maxDuration,\n    minDuration,\n    recordTime,\n    required,\n    value,\n  ])\n\n  const handleValidate = useCallback(() => {\n    const message = getValidateMessage()\n    handleUpdateMultiExecutionResult([\n      {\n        displayName,\n        value: {\n          validateMessage: message,\n        },\n      },\n    ])\n    return message\n  }, [displayName, getValidateMessage, handleUpdateMultiExecutionResult])\n\n  const handleOnChange = useCallback(\n    (value: string) => {\n      new Promise((resolve) => {\n        handleUpdateMultiExecutionResult([\n          {\n            displayName,\n            value: {\n              value: getDataFromVal(value),\n              dataURI: value,\n            },\n          },\n        ])\n        resolve(true)\n      }).then(() => {\n        triggerEventHandler(\"change\")\n      })\n    },\n    [displayName, handleUpdateMultiExecutionResult, triggerEventHandler],\n  )\n\n  const handleUpdateStatus = useCallback(\n    (value: Record<string, number | string>) => {\n      handleUpdateMultiExecutionResult([\n        {\n          displayName,\n          value,\n        },\n      ])\n    },\n    [displayName, handleUpdateMultiExecutionResult],\n  )\n\n  useEffect(() => {\n    updateComponentRuntimeProps({\n      clearValue: () => {\n        handleUpdateMultiExecutionResult([\n          {\n            displayName,\n            value: {\n              value: undefined,\n            },\n          },\n        ])\n      },\n      validate: () => {\n        return handleValidate()\n      },\n      clearValidation: () => {\n        handleUpdateMultiExecutionResult([\n          {\n            displayName,\n            value: {\n              validateMessage: undefined,\n            },\n          },\n        ])\n      },\n    })\n    return () => {\n      deleteComponentRuntimeProps()\n    }\n  }, [\n    updateComponentRuntimeProps,\n    deleteComponentRuntimeProps,\n    handleValidate,\n    handleUpdateMultiExecutionResult,\n    displayName,\n    value,\n    recordTime,\n    isRecording,\n    messageModal,\n  ])\n\n  return (\n    <AutoHeightContainer updateComponentHeight={updateComponentHeight}>\n      <TooltipWrapper tooltipText={tooltipText} tooltipDisabled={!tooltipText}>\n        <WrappedRecording\n          {...props}\n          handleOnChange={handleOnChange}\n          handleUpdateStatus={handleUpdateStatus}\n          handleUpdateMultiExecutionResult={handleUpdateMultiExecutionResult}\n        />\n      </TooltipWrapper>\n      {!hideValidationMessage && (\n        <div>\n          <InvalidMessage validateMessage={validateMessage} />\n        </div>\n      )}\n    </AutoHeightContainer>\n  )\n}\nRecordingWidget.displayName = \"RecordingWidget\"\nexport default RecordingWidget\n"],"names":["applyPreviewStyle","css","audioContainerStyle","applyContainerStyle","applyTextButtonStyle","setInternalByTimeout","callback","interval","startTime","timerId","deviation","run","expected","drift","getsSafeNodeValue","val","getDataFromVal","rep","useHandleRecord","handleUpdateStatus","handleOnChange","isRecording","setIsRecording","useState","useRef","recordingTime","setRecordingTime","cancelTimer","chunks","recorder","stream","url","setUrl","startRecordFnRef","dataRecordFnRef","stopRecordFnRef","handleButtonClick","useCallback","currentRecorder","value","e","track","audioBlob","reader","data","_a","error","clearData","useEffect","BaseRecorder","props","loading","disabled","startText","stopText","clearText","colorScheme","permissionStatus","permissionDisabled","setPermissionDisabled","emptyFun","handlePermissionChange","event","result","RecordPermission","status","jsxs","jsx","Button","DefaultStopText","DefaultStartText","DefaultClearText","createElement","WrappedAudio","WrappedRecording","forwardRef","ref","RecordingWidget","displayName","minDuration","maxDuration","required","recordTime","tooltipText","customRule","hideValidationMessage","validateMessage","triggerEventHandler","updateComponentHeight","handleUpdateMultiExecutionResult","updateComponentRuntimeProps","deleteComponentRuntimeProps","messageModal","useMessage","getValidateMessage","message","handleValidateCheck","handleValidate","resolve","AutoHeightContainer","TooltipWrapper","InvalidMessage"],"mappings":"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"}