{"version":3,"file":"utils-1cfed9ac.js","sources":["../../src/widgetLibrary/PublicSector/InvalidMessage/style.tsx","../../src/widgetLibrary/PublicSector/InvalidMessage/index.tsx","../../src/widgetLibrary/PublicSector/InvalidMessage/utils.tsx"],"sourcesContent":["import { css } from \"@emotion/react\"\nimport { globalColor, illaPrefix } from \"@illa-design/react\"\n\nexport const invalidateMessageCss = css`\n  display: flex;\n  padding: 8px 0;\n  width: 100%;\n  align-items: center;\n  color: ${globalColor(`--${illaPrefix}-orange-03`)};\n  font-size: 14px;\n\n  svg {\n    margin-right: 8px;\n  }\n`\n","import { FC } from \"react\"\nimport { WarningCircleIcon } from \"@illa-design/react\"\nimport { ValidateMessageNewProps } from \"@/widgetLibrary/PublicSector/InvalidMessage/interface\"\nimport { invalidateMessageCss } from \"./style\"\n\nexport const InvalidMessage: FC<ValidateMessageNewProps> = (props) => {\n  const { validateMessage } = props\n\n  return (\n    <>\n      {typeof validateMessage === \"string\" && validateMessage.length > 0 && (\n        <span css={invalidateMessageCss}>\n          <WarningCircleIcon />\n          {validateMessage}\n        </span>\n      )}\n    </>\n  )\n}\n","import { isString } from \"@illa-design/react\"\nimport i18n from \"@/i18n/config\"\nimport { ValidateCheckProps } from \"@/widgetLibrary/PublicSector/InvalidMessage/interface\"\n\nconst validateEmail = (email: string) => {\n  const str =\n    /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\n  const emailMatchPattern = new RegExp(str)\n  return emailMatchPattern.test(email)\n}\n\nfunction isValidURL(str: string) {\n  const matchStr = /^(?:\\w+:)?\\/\\/([^\\s\\.]+\\.\\S{2}|localhost[\\:?\\d]*)\\S*$/\n  const urlMatchPattern = new RegExp(matchStr)\n  return urlMatchPattern.test(str)\n}\n\nexport const handleCheckCustomRule = (customRule: unknown) => {\n  if (customRule != undefined && customRule !== \"\") {\n    return true\n  }\n}\n\nexport const handleCheckMinSelectedItems = (\n  value: unknown,\n  minCount?: number,\n) => {\n  if (\n    typeof minCount === \"number\" &&\n    ((Array.isArray(value) && value.length < minCount) ||\n      typeof value === \"undefined\")\n  ) {\n    return true\n  }\n}\n\nexport const handleCheckMaxSelectedItems = (\n  value: unknown,\n  maxCount?: number,\n) => {\n  if (\n    typeof maxCount === \"number\" &&\n    ((Array.isArray(value) && value.length > maxCount) ||\n      typeof value === \"undefined\")\n  ) {\n    return true\n  }\n}\n\nexport const handleCheckIsRequired = (value: unknown, required?: boolean) => {\n  if (\n    required &&\n    (typeof value === \"undefined\" ||\n      (Array.isArray(value) && value.length === 0))\n  )\n    return true\n}\n\nexport const handleCheckMaxLength = (value: unknown, maxLength?: number) => {\n  if (\n    typeof maxLength === \"number\" &&\n    ((typeof value === \"string\" && value.length > maxLength) ||\n      typeof value === \"undefined\")\n  )\n    return true\n}\n\nexport const handleCheckMinLength = (value: unknown, minLength?: number) => {\n  if (\n    typeof minLength === \"number\" &&\n    ((typeof value === \"string\" && value.length < minLength) ||\n      typeof value === \"undefined\")\n  )\n    return true\n}\n\nexport const handleCheckMinDuration = (\n  value: unknown,\n  minDuration?: number,\n) => {\n  if (\n    typeof minDuration === \"number\" &&\n    ((typeof value === \"number\" && value < minDuration) ||\n      typeof value === \"undefined\")\n  )\n    return true\n}\n\nexport const handleCheckMaxDuration = (\n  value: unknown,\n  maxDuration?: number,\n) => {\n  if (\n    typeof maxDuration === \"number\" &&\n    ((typeof value === \"number\" && value > maxDuration) ||\n      typeof value === \"undefined\")\n  )\n    return true\n}\n\nexport const handleCheckPattern = (\n  value: unknown,\n  pattern: ValidateCheckProps[\"pattern\"],\n  reg?: string,\n) => {\n  switch (pattern) {\n    case \"Email\": {\n      if (\n        (typeof value === \"string\" && !validateEmail(value)) ||\n        typeof value === \"undefined\"\n      ) {\n        return i18n.t(\"editor.validate_message.email\")\n      }\n      break\n    }\n    case \"URL\": {\n      if (\n        (typeof value === \"string\" && !isValidURL(value)) ||\n        typeof value === \"undefined\"\n      ) {\n        return i18n.t(\"editor.validate_message.url\")\n      }\n      break\n    }\n    case \"Regex\":\n      if (!reg || typeof value === undefined) return\n      try {\n        let finalReg = reg\n        if (reg.startsWith(\"/\") && reg.endsWith(\"/\")) {\n          finalReg = reg.slice(1, reg.length - 1)\n        }\n        const matchPattern = new RegExp(finalReg)\n        if (typeof value !== \"string\" || !matchPattern.test(value)) {\n          return i18n.t(\"editor.validate_message.regex\")\n        }\n      } catch (e) {\n        console.error(\"regex error\", e)\n      }\n  }\n}\n\nexport const calculateFileSize = (data: unknown) => {\n  const blobArr = Array.isArray(data) ? data : [data]\n  const byteSize = new Blob(blobArr).size\n  return byteSize\n}\n\nconst handleCheckFileSize = (\n  value: unknown,\n  maxSize?: number,\n  minSize?: number,\n  sizeType?: string,\n) => {\n  if (value && (value as []).length) {\n    // default to MB\n    const getFileSizeNumber = (type?: string) =>\n      type !== \"mb\" ? 1024 : 1024 * 1024\n\n    const maxSizeNumber = maxSize ? maxSize * getFileSizeNumber(sizeType) : 0\n    const minSizeNumber = minSize ? minSize * getFileSizeNumber(sizeType) : 0\n\n    for (let i = 0; i < (value as []).length; i++) {\n      const size =\n        (value as any)[i].originFile?.size ||\n        calculateFileSize((value as any)[i].originFile)\n\n      if (!!maxSizeNumber && size > maxSizeNumber) {\n        return {\n          hasError: true,\n          errorMessage: i18n.t(\"editor.validate_message.max_size\", {\n            maxSize,\n            type: (sizeType || \"MB\").toUpperCase(),\n          }),\n        }\n      }\n      if (!!minSizeNumber && size < minSizeNumber) {\n        return {\n          hasError: true,\n          errorMessage: i18n.t(\"editor.validate_message.min_size\", {\n            minSize,\n            type: (sizeType || \"MB\").toUpperCase(),\n          }),\n        }\n      }\n    }\n  }\n  return {\n    hasError: false,\n    errorMessage: \"\",\n  }\n}\n\nconst handleCheckFilesCount = (\n  value: unknown,\n  maxFiles?: number,\n  minFiles?: number,\n) => {\n  if (value) {\n    const length = (value as []).length\n    if (maxFiles && length > maxFiles) {\n      return {\n        fileCountInvalid: true,\n        countErrorMessage: i18n.t(\"editor.validate_message.max_files\", {\n          maxFiles,\n        }),\n      }\n    }\n    if (minFiles && length < minFiles) {\n      return {\n        fileCountInvalid: true,\n        countErrorMessage: i18n.t(\"editor.validate_message.min_files\", {\n          minFiles,\n        }),\n      }\n    }\n  }\n  return {\n    fileCountInvalid: false,\n    countErrorMessage: \"\",\n  }\n}\n\nexport const handleValidateCheck = (\n  options?: ValidateCheckProps,\n): string | undefined => {\n  if (typeof options === \"undefined\") return\n  if (handleCheckCustomRule(options.customRule)) {\n    try {\n      return typeof options.customRule === \"string\"\n        ? options.customRule\n        : JSON.stringify(options.customRule)\n    } catch (e) {\n      console.error(\"custom rule is error\")\n    }\n  }\n\n  const { hasError, errorMessage } = handleCheckFileSize(\n    options.value,\n    options.maxSize,\n    options.minSize,\n    options.sizeType,\n  )\n  if (hasError) {\n    return errorMessage\n  }\n\n  const { fileCountInvalid, countErrorMessage } = handleCheckFilesCount(\n    options.value,\n    options.maxFiles,\n    options.minFiles,\n  )\n  if (fileCountInvalid) {\n    return countErrorMessage\n  }\n\n  if (handleCheckMinSelectedItems(options.value, options.atLeastNumber)) {\n    return i18n.t(\"editor.inspect.setter_message.choose_at_least\", {\n      min: options.atLeastNumber,\n    })\n  }\n\n  if (handleCheckMaxSelectedItems(options.value, options.upToNumber)) {\n    return i18n.t(\"editor.inspect.setter_message.choose_up_to\", {\n      max: options.upToNumber,\n    })\n  }\n\n  if (handleCheckIsRequired(options.value, options.required)) {\n    return i18n.t(\"editor.validate_message.required\")\n  }\n\n  if (handleCheckMaxLength(options.value, options.maxLength)) {\n    return i18n.t(\"editor.validate_message.max_length\", {\n      number: options.maxLength,\n    })\n  }\n\n  if (handleCheckMinLength(options.value, options.minLength)) {\n    return i18n.t(\"editor.validate_message.min_value\", {\n      number: options.minLength,\n    })\n  }\n\n  if (handleCheckMaxDuration(options.value, options.maxDuration)) {\n    return i18n.t(\"editor.inspect.setter_message.recording.max_duration\", {\n      maximum: options.maxDuration,\n    })\n  }\n\n  if (handleCheckMinDuration(options.value, options.minDuration)) {\n    return i18n.t(\"editor.inspect.setter_message.recording.min_duration\", {\n      minimum: options.minDuration,\n    })\n  }\n\n  return handleCheckPattern(options.value, options.pattern, options.regex)\n}\n\nexport const getValidateVFromString = (value: unknown) => {\n  return isString(value) && !value ? undefined : value\n}\n"],"names":["invalidateMessageCss","css","globalColor","illaPrefix","InvalidMessage","props","validateMessage","jsx","Fragment","jsxs","WarningCircleIcon","validateEmail","email","str","isValidURL","matchStr","handleCheckCustomRule","customRule","handleCheckMinSelectedItems","value","minCount","handleCheckMaxSelectedItems","maxCount","handleCheckIsRequired","required","handleCheckMaxLength","maxLength","handleCheckMinLength","minLength","handleCheckMinDuration","minDuration","handleCheckMaxDuration","maxDuration","handleCheckPattern","pattern","reg","i18n","finalReg","matchPattern","e","calculateFileSize","data","blobArr","handleCheckFileSize","maxSize","minSize","sizeType","getFileSizeNumber","type","maxSizeNumber","minSizeNumber","i","size","_a","handleCheckFilesCount","maxFiles","minFiles","length","handleValidateCheck","options","hasError","errorMessage","fileCountInvalid","countErrorMessage","getValidateVFromString","isString"],"mappings":"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"}