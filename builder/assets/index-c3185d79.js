import{k as t,o as c,n as D,aY as L,B as U,aa as w,F as g,bd as W}from"./@illa-design-1f43bb6c.js";import{u as B,gE as F,gF as M,gG as f,gJ as j,gK as G,d6 as A,gT as K,gM as H,gI as J,gH as O}from"./index-4dce6ee8.js";import{r as v}from"./react-9b7e00e3.js";import{c as Y,C as d,f as $,l as z,b as Q,h as X,d as Z,e as y,a as P}from"./style-49dd2bac.js";import{R}from"./index-d6273125.js";import"./@emotion-08a6282b.js";import"./codeMirror-vendor-320207e2.js";import"./lodash-lib-6e94956b.js";import"./react-icons-vendor-2430ea65.js";const ee="5432",x=n=>{const a=/^(.*):\/\/(.*):(.*)@(.*?)(?::(\d+))?\/(.*)$/,e=n.match(a);return e?{roleName:e[2]||null,password:e[3]||null,hostWithoutPort:e[4]||null,dbName:e[6]||null}:{roleName:null,password:null,hostWithoutPort:null,dbName:null}},te=n=>{if(!n)return"";const a="editor.action.form.tips.neon.failed";if(!/^postgres:/i.test(n))return a;const{roleName:r,dbName:u,hostWithoutPort:s,password:p}=x(n);return r===null||s===null||s&&!K(s)||u===null?a:p===null?"editor.action.form.tips.neon.no_password":""},oe=n=>{const{resourceID:a}=n,{t:e}=B(),{control:r,reset:u,getValues:s,formState:p,watch:C}=F(),{getResourceByID:S}=v.useContext(M),o=S(a),T=C("host"),m=C("connectionString"),N=H(T??""),l=te(m),V=i=>()=>window.open(i,"_blank"),I=v.useCallback(()=>{const i=x(m),{resourceName:h}=s(),{roleName:b,password:k,hostWithoutPort:E,dbName:q}=i;u({resourceName:h,connectionString:"",host:E??"",databaseName:q,databaseUsername:b,databasePassword:k})},[m,u,s]),_=()=>t(O,{i18nKey:"editor.action.form.tips.neon.normal",t:e,components:[t(J,{onClick:V("https://console.neon.tech/app/projects/")},"editor.action.form.tips.neon.normal")]});return t(g,{children:c("div",{css:Y,children:[t(d,{controlledType:"input",isRequired:!0,title:e("editor.action.resource.db.label.name"),control:r,defaultValue:(o==null?void 0:o.resourceName)??"",rules:[{validate:f}],placeholders:[e("editor.action.resource.db.placeholder.name")],name:"resourceName",tips:e("editor.action.resource.restapi.tip.name")}),t(R,{type:"General Option"}),c("div",{css:$,children:[t("div",{css:z,children:t("span",{css:Q(D("grayBlue","02")),children:e("editor.action.form.option.neon.connection_string")})}),c("div",{css:X,children:[t(j,{control:r,defaultValue:"",rules:{validate:()=>!l},render:({field:{value:i,onChange:h,onBlur:b}})=>t(L,{w:"100%",onBlur:b,onChange:h,error:!!l,value:i,colorScheme:"techPurple",placeholder:"postgres://testUser:abcdefg@ep-restless-rice-862380.us-east-2.aws.neon.tech/neondb"}),name:"connectionString"}),t(U,{disabled:!!l||!m,onClick:I,colorScheme:"techPurple",h:"32px",children:e("editor.action.form.option.neon.parse")})]})]}),t("div",{css:Z,children:l?c("div",{css:y,children:[t(w,{css:P}),t(g,{children:e(l)})]}):t("div",{children:t(_,{})})}),t(d,{title:e("editor.action.resource.db.label.hostname_port"),defaultValue:[o==null?void 0:o.content.host,+((o==null?void 0:o.content.port)??ee)],name:["host","port"],controlledType:["input","number"],control:r,isRequired:!0,rules:[{validate:G},{required:!0}],styles:[{flex:4},{flex:1}],placeholders:[e("editor.action.resource.db.placeholder.hostname")],tips:p.errors.host&&!N?c("div",{css:y,children:[t(w,{css:P}),t(g,{children:p.errors.host.message})]}):null}),N&&t(d,{defaultValue:"",name:"",title:"",controlledType:"none",control:r,tips:t(W,{title:e("editor.action.form.tips.connect_to_local.title.tips"),closable:!1,content:e("editor.action.form.tips.connect_to_local.selfhost")})}),t(d,{title:e("editor.action.resource.db.label.database"),defaultValue:o==null?void 0:o.content.databaseName,name:"databaseName",controlledType:"input",control:r,isRequired:!0,rules:[{validate:f}],placeholders:[e("editor.action.resource.db.placeholder.database")]}),t(d,{title:e("editor.action.resource.db.label.username_password"),defaultValue:[o==null?void 0:o.content.databaseUsername,o==null?void 0:o.content.databasePassword],name:["databaseUsername","databasePassword"],controlledType:["input","password"],control:r,isRequired:!0,rules:[{validate:f},{required:!0}],placeholders:[e("editor.action.resource.db.placeholder.username"),e("editor.action.resource.db.placeholder.password")]}),A]})})};oe.displayName="NeonConfigElement";export{oe as default};
//# sourceMappingURL=index-c3185d79.js.map
