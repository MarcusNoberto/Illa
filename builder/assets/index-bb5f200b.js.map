{"version":3,"file":"index-bb5f200b.js","sources":["../../src/page/App/components/Actions/ActionPanel/GraphQLPanel/style.ts","../../src/page/App/components/Actions/ActionPanel/GraphQLPanel/index.tsx"],"sourcesContent":["import { css } from \"@emotion/react\"\n\nexport const actionItemContainer = css`\n  padding: 8px 0;\n`\n","import { ActionItem, GraphQLAction } from \"@illa-public/public-types\"\nimport { Params } from \"@illa-public/public-types\"\nimport { FC, useCallback } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport { useDispatch, useSelector } from \"react-redux\"\nimport { CODE_LANG } from \"@/components/CodeEditor/CodeMirror/extensions/interface\"\nimport { RecordEditor } from \"@/components/RecordEditor\"\nimport { TransformerComponent } from \"@/page/App/components/Actions/ActionPanel/TransformerComponent\"\nimport { InputEditor } from \"@/page/App/components/Actions/InputEditor\"\nimport { getCachedAction } from \"@/redux/config/configSelector\"\nimport { configActions } from \"@/redux/config/configSlice\"\nimport { VALIDATION_TYPES } from \"@/utils/validationFactory\"\nimport { actionItemContainer } from \"./style\"\n\nconst GraphQLPanel: FC = () => {\n  const { t } = useTranslation()\n\n  const cachedAction = useSelector(getCachedAction) as ActionItem<GraphQLAction>\n  const content = cachedAction.content as GraphQLAction\n\n  const dispatch = useDispatch()\n\n  const handleValueChange = useCallback(\n    (value: string | Params[], name: string) => {\n      dispatch(\n        configActions.updateCachedAction({\n          ...cachedAction,\n          content: {\n            ...content,\n            [name]: value,\n          },\n        }),\n      )\n    },\n    [cachedAction, content, dispatch],\n  )\n\n  const handleOnAddKeys = useCallback(\n    (name?: string) => {\n      if (name && content.hasOwnProperty(name)) {\n        const oldList = content[name as keyof typeof content] as Params[]\n        let newList: Params[] = [...oldList, { key: \"\", value: \"\" } as Params]\n        dispatch(\n          configActions.updateCachedAction({\n            ...cachedAction,\n            content: {\n              ...content,\n              [name]: newList,\n            },\n          }),\n        )\n      }\n    },\n    [cachedAction, content, dispatch],\n  )\n\n  const handleOnDeleteKeyValue = useCallback(\n    (index: number, record: Params, name?: string) => {\n      if (name && content.hasOwnProperty(name)) {\n        const oldList = content[name as keyof typeof content] as Params[]\n        let newList = [...oldList]\n        newList.splice(index, 1)\n        if (newList.length === 0) {\n          newList = [{ key: \"\", value: \"\" }]\n        }\n        dispatch(\n          configActions.updateCachedAction({\n            ...cachedAction,\n            content: {\n              ...content,\n              [name]: newList,\n            },\n          }),\n        )\n      }\n    },\n    [cachedAction, content, dispatch],\n  )\n\n  const handleOnChangeKeyOrValue = useCallback(\n    (index: number, key: string, value: string, name?: string) => {\n      if (name && content.hasOwnProperty(name)) {\n        const oldList = content[name as keyof typeof content] as Params[]\n        let newList: Params[] = [...oldList]\n        newList[index] = { key, value } as Params\n        dispatch(\n          configActions.updateCachedAction({\n            ...cachedAction,\n            content: {\n              ...content,\n              [name]: newList,\n            },\n          }),\n        )\n      }\n    },\n    [cachedAction, content, dispatch],\n  )\n\n  return (\n    <div css={actionItemContainer}>\n      <InputEditor\n        lineNumbers\n        title={t(\"editor.action.panel.graphql.query\")}\n        placeholder={t(\"editor.action.panel.graphql.placeholder.query\")}\n        value={content.query}\n        onChange={(value) => handleValueChange(value, \"query\")}\n        mode={CODE_LANG.SQL}\n        style={{ height: \"88px\" }}\n        expectedType={VALIDATION_TYPES.STRING}\n      />\n      <RecordEditor\n        key=\"variables\"\n        label={t(\"editor.action.panel.graphql.variables\")}\n        records={content.variables}\n        name=\"variables\"\n        onAdd={handleOnAddKeys}\n        onDelete={handleOnDeleteKeyValue}\n        onChangeKey={handleOnChangeKeyOrValue}\n        onChangeValue={handleOnChangeKeyOrValue}\n        valueInputType={VALIDATION_TYPES.ANY}\n      />\n      <RecordEditor\n        key=\"headers\"\n        label={t(\"editor.action.panel.graphql.headers\")}\n        name=\"headers\"\n        records={content.headers}\n        onAdd={handleOnAddKeys}\n        onDelete={handleOnDeleteKeyValue}\n        onChangeKey={handleOnChangeKeyOrValue}\n        onChangeValue={handleOnChangeKeyOrValue}\n      />\n      <TransformerComponent />\n    </div>\n  )\n}\n\nGraphQLPanel.displayName = \"GraphQLPanel\"\nexport default GraphQLPanel\n"],"names":["actionItemContainer","css","GraphQLPanel","t","useTranslation","cachedAction","useSelector","getCachedAction","content","dispatch","useDispatch","handleValueChange","useCallback","value","name","configActions","handleOnAddKeys","newList","handleOnDeleteKeyValue","index","record","handleOnChangeKeyOrValue","key","jsxs","jsx","InputEditor","CODE_LANG","VALIDATION_TYPES","RecordEditor","TransformerComponent"],"mappings":"ymCAEO,MAAMA,EAAsBC;AAAA;AAAA,ECY7BC,EAAmB,IAAM,CACvB,KAAA,CAAE,EAAAC,GAAMC,IAERC,EAAeC,EAAYC,CAAe,EAC1CC,EAAUH,EAAa,QAEvBI,EAAWC,IAEXC,EAAoBC,EAAA,YACxB,CAACC,EAA0BC,IAAiB,CAC1CL,EACEM,EAAc,mBAAmB,CAC/B,GAAGV,EACH,QAAS,CACP,GAAGG,EACH,CAACM,CAAI,EAAGD,CACV,CAAA,CACD,CAAA,CAEL,EACA,CAACR,EAAcG,EAASC,CAAQ,CAAA,EAG5BO,EAAkBJ,EAAA,YACrBE,GAAkB,CACjB,GAAIA,GAAQN,EAAQ,eAAeM,CAAI,EAAG,CAEpC,IAAAG,EAAoB,CAAC,GADTT,EAAQM,CAA4B,EACf,CAAE,IAAK,GAAI,MAAO,EAAA,CAAc,EACrEL,EACEM,EAAc,mBAAmB,CAC/B,GAAGV,EACH,QAAS,CACP,GAAGG,EACH,CAACM,CAAI,EAAGG,CACV,CAAA,CACD,CAAA,CAEL,CACF,EACA,CAACZ,EAAcG,EAASC,CAAQ,CAAA,EAG5BS,EAAyBN,EAAA,YAC7B,CAACO,EAAeC,EAAgBN,IAAkB,CAChD,GAAIA,GAAQN,EAAQ,eAAeM,CAAI,EAAG,CAEpC,IAAAG,EAAU,CAAC,GADCT,EAAQM,CAA4B,CAC3B,EACjBG,EAAA,OAAOE,EAAO,CAAC,EACnBF,EAAQ,SAAW,IACrBA,EAAU,CAAC,CAAE,IAAK,GAAI,MAAO,GAAI,GAEnCR,EACEM,EAAc,mBAAmB,CAC/B,GAAGV,EACH,QAAS,CACP,GAAGG,EACH,CAACM,CAAI,EAAGG,CACV,CAAA,CACD,CAAA,CAEL,CACF,EACA,CAACZ,EAAcG,EAASC,CAAQ,CAAA,EAG5BY,EAA2BT,EAAA,YAC/B,CAACO,EAAeG,EAAaT,EAAeC,IAAkB,CAC5D,GAAIA,GAAQN,EAAQ,eAAeM,CAAI,EAAG,CAEpC,IAAAG,EAAoB,CAAC,GADTT,EAAQM,CAA4B,CACjB,EACnCG,EAAQE,CAAK,EAAI,CAAE,IAAAG,EAAK,MAAAT,CAAM,EAC9BJ,EACEM,EAAc,mBAAmB,CAC/B,GAAGV,EACH,QAAS,CACP,GAAGG,EACH,CAACM,CAAI,EAAGG,CACV,CAAA,CACD,CAAA,CAEL,CACF,EACA,CAACZ,EAAcG,EAASC,CAAQ,CAAA,EAIhC,OAAAc,EAAC,MAAI,CAAA,IAAKvB,EACR,SAAA,CAAAwB,EAACC,EAAA,CACC,YAAW,GACX,MAAOtB,EAAE,mCAAmC,EAC5C,YAAaA,EAAE,+CAA+C,EAC9D,MAAOK,EAAQ,MACf,SAAWK,GAAUF,EAAkBE,EAAO,OAAO,EACrD,KAAMa,EAAU,IAChB,MAAO,CAAE,OAAQ,MAAO,EACxB,aAAcC,EAAiB,MAAA,CACjC,EACAH,EAACI,EAAA,CAEC,MAAOzB,EAAE,uCAAuC,EAChD,QAASK,EAAQ,UACjB,KAAK,YACL,MAAOQ,EACP,SAAUE,EACV,YAAaG,EACb,cAAeA,EACf,eAAgBM,EAAiB,GAAA,EAR7B,WASN,EACAH,EAACI,EAAA,CAEC,MAAOzB,EAAE,qCAAqC,EAC9C,KAAK,UACL,QAASK,EAAQ,QACjB,MAAOQ,EACP,SAAUE,EACV,YAAaG,EACb,cAAeA,CAAA,EAPX,SAQN,IACCQ,EAAqB,EAAA,CACxB,CAAA,CAAA,CAEJ,EAEA3B,EAAa,YAAc"}