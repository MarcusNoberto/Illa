{"version":3,"file":"text-39c5a4b2.js","sources":["../../src/widgetLibrary/TextWidget/style.tsx","../../src/widgetLibrary/TextWidget/text.tsx"],"sourcesContent":["import { SerializedStyles, css } from \"@emotion/react\"\nimport { getSpecialThemeColor } from \"@illa-design/react\"\nimport { VerticalAlign } from \"@/widgetLibrary/TextWidget/interface\"\n\nexport function applyAlignStyle(\n  verticalAlign?: VerticalAlign,\n): SerializedStyles {\n  return css`\n    width: 100%;\n    display: flex;\n    align-items: ${verticalAlign};\n  `\n}\n\nconst getRealHeightStyle = (\n  dynamicHeight: \"auto\" | \"fixed\" | \"limited\",\n  dynamicMinHeight: number = 0,\n  dynamicMaxHeight: number = 0,\n) => {\n  switch (dynamicHeight) {\n    case \"auto\":\n      return css`\n        height: auto;\n      `\n    case \"limited\":\n      return css`\n        min-height: ${dynamicMinHeight - 6}px;\n        height: auto;\n        max-height: ${dynamicMaxHeight - 6}px;\n      `\n    case \"fixed\":\n      return css`\n        height: 100%;\n      `\n    default:\n      return \"\"\n  }\n}\n\nexport const applyAutoHeightContainerStyle = (\n  dynamicHeight: \"auto\" | \"fixed\" | \"limited\",\n  dynamicMinHeight?: number,\n  dynamicMAxHeight?: number,\n) => {\n  return css`\n    display: flex;\n    width: 100%;\n    position: relative;\n    ${getRealHeightStyle(dynamicHeight, dynamicMinHeight, dynamicMAxHeight)};\n  `\n}\n\nexport function applyMarkdownStyle(horizontalAlign?: string): SerializedStyles {\n  return css`\n    width: 100%;\n    text-align: ${horizontalAlign};\n    overflow-wrap: break-word;\n  `\n}\n\nexport const applyTextStyle = (horizontalAlign?: string, weight?: number) => {\n  return css`\n    width: 100%;\n    font-weight: ${weight ?? 400};\n    text-align: ${horizontalAlign};\n    overflow-wrap: break-word;\n  `\n}\n\nexport const applyContainerStyle = (colorScheme: string) => {\n  return css`\n    width: 100%;\n    color: ${getSpecialThemeColor(colorScheme)};\n\n    a,\n    span {\n      color: ${getSpecialThemeColor(colorScheme)};\n    }\n  `\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableFooter,\n  TableHead,\n  TableRow,\n} from \"@mui/material\"\nimport Paper from \"@mui/material/Paper\"\nimport React, { FC, useEffect, useLayoutEffect, useRef } from \"react\"\nimport ReactMarkdown from \"react-markdown\"\nimport rehypeRaw from \"rehype-raw\"\nimport rehypeSanitize from \"rehype-sanitize\"\nimport remarkGfm from \"remark-gfm\"\nimport {\n  Heading,\n  Text as ILLAText,\n  Link,\n  Paragraph,\n  Typography,\n} from \"@illa-design/react\"\nimport { TooltipWrapper } from \"@/widgetLibrary/PublicSector/TooltipWrapper\"\nimport { HTMLTags } from \"@/widgetLibrary/TextWidget/constans\"\nimport { TextProps, TextWidgetProps } from \"./interface\"\nimport {\n  applyAlignStyle,\n  applyAutoHeightContainerStyle,\n  applyMarkdownStyle,\n  applyTextStyle,\n} from \"./style\"\n\nexport const Text: FC<TextProps> = (props) => {\n  const {\n    value,\n    horizontalAlign,\n    verticalAlign,\n    colorScheme,\n    fs,\n    disableMarkdown,\n    weight,\n  } = props\n\n  const sanitizeOptions = {\n    allowedTags: HTMLTags,\n  }\n\n  return (\n    <div css={applyAlignStyle(verticalAlign)}>\n      {disableMarkdown ? (\n        <ILLAText\n          css={applyTextStyle(horizontalAlign, weight)}\n          colorScheme={colorScheme}\n          fs={fs}\n        >\n          {value}\n        </ILLAText>\n      ) : (\n        <Typography w=\"100%\" c={colorScheme}>\n          <ReactMarkdown\n            css={applyMarkdownStyle(horizontalAlign)}\n            remarkPlugins={[remarkGfm]}\n            rehypePlugins={[rehypeRaw, [rehypeSanitize, sanitizeOptions]]}\n            components={{\n              a: ({ href, children }) => (\n                <Link href={href} target=\"_blank\">\n                  {children}\n                </Link>\n              ),\n              code: ({ children }) => (\n                <ILLAText code colorScheme={colorScheme}>\n                  {children}\n                </ILLAText>\n              ),\n              p: ({ children }) => (\n                <Paragraph colorScheme={colorScheme}>{children}</Paragraph>\n              ),\n              h1: ({ children }) => (\n                <Heading level=\"h1\" colorScheme={colorScheme}>\n                  {children}\n                </Heading>\n              ),\n              h2: ({ children }) => (\n                <Heading level=\"h2\" colorScheme={colorScheme}>\n                  {children}\n                </Heading>\n              ),\n              h3: ({ children }) => (\n                <Heading level=\"h3\" colorScheme={colorScheme}>\n                  {children}\n                </Heading>\n              ),\n              h4: ({ children }) => (\n                <Heading level=\"h4\" colorScheme={colorScheme}>\n                  {children}\n                </Heading>\n              ),\n              h5: ({ children }) => (\n                <Heading level=\"h5\" colorScheme={colorScheme}>\n                  {children}\n                </Heading>\n              ),\n              h6: ({ children }) => (\n                <Heading level=\"h6\" colorScheme={colorScheme}>\n                  {children}\n                </Heading>\n              ),\n              tr: ({ children }) => <TableRow>{children}</TableRow>,\n              th: ({ children }) => (\n                <TableCell align=\"center\">{children}</TableCell>\n              ),\n              td: ({ children }) => (\n                <TableCell align=\"left\">{children}</TableCell>\n              ),\n              thead: ({ children }) => <TableHead>{children}</TableHead>,\n              tbody: ({ children }) => <TableBody>{children}</TableBody>,\n              tfoot: ({ children }) => <TableFooter>{children}</TableFooter>,\n              table: ({ children }) => (\n                <TableContainer component={Paper}>\n                  <Table sx={{ minWidth: 650 }}>{children}</Table>\n                </TableContainer>\n              ),\n            }}\n          >\n            {value ?? \"\"}\n          </ReactMarkdown>\n        </Typography>\n      )}\n    </div>\n  )\n}\n\nText.displayName = \"Text\"\n\nexport const TextWidget: FC<TextWidgetProps> = (props) => {\n  const {\n    value,\n    horizontalAlign,\n    verticalAlign = \"start\",\n    handleUpdateDsl,\n    updateComponentRuntimeProps,\n    deleteComponentRuntimeProps,\n    updateComponentHeight,\n    disableMarkdown,\n    tooltipText,\n    dynamicHeight = \"fixed\",\n    dynamicMinHeight,\n    dynamicMaxHeight,\n    colorScheme,\n    fs,\n    fw,\n    weight,\n  } = props\n\n  useEffect(() => {\n    updateComponentRuntimeProps({\n      setValue: (value: string) => {\n        handleUpdateDsl({ value })\n      },\n      clearValue: () => {\n        handleUpdateDsl({ value: undefined })\n      },\n    })\n\n    return () => {\n      deleteComponentRuntimeProps()\n    }\n  }, [\n    deleteComponentRuntimeProps,\n    handleUpdateDsl,\n    updateComponentRuntimeProps,\n  ])\n\n  const enableAutoHeight =\n    dynamicHeight !== \"fixed\" && dynamicHeight != undefined\n\n  const containerRef = useRef<HTMLDivElement | null>(null)\n\n  useLayoutEffect(() => {\n    const containerDOM = containerRef.current\n    const observerRef = new ResizeObserver((entries) => {\n      if (!updateComponentHeight) return\n      const height = entries[0].contentRect.height\n      updateComponentHeight?.(height)\n    })\n    if (observerRef && containerDOM && enableAutoHeight) {\n      observerRef.unobserve(containerDOM)\n      observerRef.observe(containerDOM)\n    }\n\n    return () => {\n      if (containerDOM && enableAutoHeight) {\n        observerRef.unobserve(containerDOM)\n      }\n    }\n  }, [enableAutoHeight, updateComponentHeight])\n\n  return (\n    <TooltipWrapper tooltipText={tooltipText} tooltipDisabled={!tooltipText}>\n      <div\n        ref={containerRef}\n        css={applyAutoHeightContainerStyle(\n          dynamicHeight,\n          dynamicMinHeight,\n          dynamicMaxHeight,\n        )}\n      >\n        <Text\n          weight={weight}\n          horizontalAlign={horizontalAlign}\n          value={value}\n          verticalAlign={verticalAlign}\n          colorScheme={colorScheme}\n          fs={fs}\n          fw={fw}\n          disableMarkdown={disableMarkdown}\n        />\n      </div>\n    </TooltipWrapper>\n  )\n}\n\nTextWidget.displayName = \"TextWidget\"\nexport default TextWidget\n"],"names":["applyAlignStyle","verticalAlign","css","getRealHeightStyle","dynamicHeight","dynamicMinHeight","dynamicMaxHeight","applyAutoHeightContainerStyle","dynamicMAxHeight","applyMarkdownStyle","horizontalAlign","applyTextStyle","weight","Text","props","value","colorScheme","fs","disableMarkdown","sanitizeOptions","HTMLTags","jsx","ILLAText","Typography","ReactMarkdown","remarkGfm","rehypeRaw","rehypeSanitize","href","children","Link","Paragraph","Heading","TableRow","TableCell","TableHead","TableBody","TableFooter","TableContainer","Paper","Table","TextWidget","handleUpdateDsl","updateComponentRuntimeProps","deleteComponentRuntimeProps","updateComponentHeight","tooltipText","fw","useEffect","enableAutoHeight","containerRef","useRef","useLayoutEffect","containerDOM","observerRef","entries","height","TooltipWrapper"],"mappings":"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"}