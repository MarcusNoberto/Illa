import{v as N,k as l,F as S,o as C}from"./@illa-design-1f43bb6c.js";import{r as i}from"./react-9b7e00e3.js";import{hg as M,b as T,ci as b}from"./index-4dce6ee8.js";import{C as x,L as E,c as I,D as _}from"./listItem-2bf53712.js";import{r as v,g as u}from"./lodash-lib-6e94956b.js";import{A as w}from"./addActionLabel-34b230bc.js";import"./@emotion-08a6282b.js";import"./codeMirror-vendor-320207e2.js";import"./react-icons-vendor-2430ea65.js";import"./index-934389e2.js";let f=new Set;const G=()=>{let a=1,e=`Dataset ${a}`;for(;f.has(e);)a++,e=`Dataset ${a}`;return e},H=(a,e,t,s)=>{const r=x["illa-preset"];let n=r[t.length%r.length];if(e||a==="pie")n="illa-preset";else if(t.length<=r.length){const m=v(r,t);m.length>0&&(n=m[0])}else n=r[t.length%r.length];f=new Set(s);const d=G();return{id:N(),datasetName:d,datasetValues:"",aggregationMethod:M.SUM,type:a,color:n}},L=a=>{const{datasets:e}=a;return l(S,{children:e==null?void 0:e.map((t,s)=>l(E,{index:s,color:t.color,isHidden:t.isHidden,datasetMethod:t.aggregationMethod,datasetName:t.datasetName},t.id))})},O=a=>{const{value:e,childrenSetter:t,handleUpdateDsl:s,attrName:r,widgetDisplayName:n,labelName:d,labelDesc:m}=a,c=T(o=>{const p=b(o);return u(p,n,{})}),h=i.useMemo(()=>!!u(c,"groupBy",""),[c]),g=i.useMemo(()=>u(c,"chartType","bar"),[c]),A=i.useMemo(()=>Array.isArray(e)?e.map(o=>o.color):[],[e]),D=i.useMemo(()=>Array.isArray(e)?e.map(o=>o.datasetName):[],[e]),y=i.useCallback(async()=>{let o=Array.isArray(e)?e:[];const p=H(g,h,A,D);s(r,[...o,p])},[r,g,s,A,D,h,e]);return!t||!Array.isArray(t)||t.length<1?null:l(_,{attrPath:r,handleUpdateDsl:s,widgetDisplayName:n,childrenSetter:t,datasets:e,children:C("div",{css:I,children:[l(w,{labelName:d,labelDesc:m,handleAddItem:y}),l(L,{datasets:e})]})})};O.displayName="ChartDatasetsSetter";export{O as default};
//# sourceMappingURL=index-5c090552.js.map
