import{k as l,bA as ne,b8 as ae}from"./@illa-design-1f43bb6c.js";import{r as t}from"./react-9b7e00e3.js";import{e as se,de as k,bl as M,aS as D,bg as O,df as oe,dg as T,dh as U,di as _,aH as L,dl as re,du as ie,eK as ce,ct as le}from"./index-4dce6ee8.js";import{R as de}from"./index-5be17f9b.js";import{E as ue,l as pe,n as me}from"./renderComponentCanvasContainer-2e4cd54a.js";import{d as he}from"./style-49f23046.js";import{g as x,M as ge,t as H,s as v,h as fe}from"./lodash-lib-6e94956b.js";const B=t.memo(b=>{const{componentNode:s,unitW:i}=b,{displayName:n,type:h,w:y,h:g,childrenNode:f,props:P}=s,o=se(),E=t.useCallback(e=>{k.addRuntimeProp(n,e)},[n]),J=t.useCallback(()=>{k.deleteRuntimeProp(n)},[n]),w=t.useMemo(()=>P??{},[P]),q=t.useCallback(e=>{o(M.updateExecutionByDisplayNameReducer({displayName:n,value:e}))},[o,n]),j=t.useCallback(e=>{o(M.updateExecutionByMultiDisplayNameReducer(e))},[o]),F=t.useCallback((e,c)=>{D(e)&&o(O.updateComponentPropsReducer({displayName:n,updateSlice:e,notUseUndoRedo:c}))},[o,n]),z=t.useCallback((e,c,u)=>{!e||!D(c)||o(O.updateComponentPropsReducer({displayName:e,updateSlice:c,notUseUndoRedo:u}))},[o]),W=t.useCallback((e,c,u)=>{const p=x(s.props,c,[]),r=x(s.props,"$dynamicAttrPaths",[]),d=oe(p).filter(a=>a.eventType===e).map(a=>({...a,originEnable:a.enabled})),m=k.getCurrentPageCalcContext(u);return{dynamicPaths:r,needRunEvents:d,finalContext:m}},[s.props]),V=t.useCallback((e,c="events",u,p)=>{const{dynamicPaths:r,needRunEvents:d,finalContext:m}=W(e,c,u);r==null||r.forEach(a=>{const C=ge(p)?p(a):T(H(a).slice(1)),N=x(d,C,"");if(N)try{const te=U("",N,m);v(d,C,te)}catch{v(d,C,void 0)}}),d.forEach(a=>{_(a,m)})},[W]),$=t.useCallback((e,c="events",u)=>{const{dynamicPaths:p,needRunEvents:r,finalContext:d}=W(e,c);p==null||p.forEach(m=>{const a=T(H(m).slice(2)),C=x(r,a,"");if(C)try{const N=U("",C,d);Array.isArray(N)&&fe(u)?v(r,a,N[u]):v(r,a,N)}catch{v(r,a,void 0)}}),r.forEach(m=>{_(m,d)})},[W]);if(!h)return null;const A=re(h);if(!A)return null;const G=A.widget,{hidden:K,borderColor:Q,backgroundColor:Y,radius:S,borderWidth:R,shadow:X}=w,Z=isNaN(Number(S))?S==null?void 0:S.toString():S+"px",ee=isNaN(Number(R))?R==null?void 0:R.toString():R+"px";return l(ue,{children:K?null:l("div",{css:he(Q,ee,Z,Y,X,h),children:l(t.Suspense,{fallback:l(ne,{animation:!0,text:!1,image:{shape:"square",w:"100%",h:"100%",mr:"0 !important"},h:"100%",w:"100%"}),children:l(G,{...w,w:y,h:g,unitW:i,unitH:L,updateComponentRuntimeProps:E,deleteComponentRuntimeProps:J,handleUpdateOriginalDSLMultiAttr:F,handleUpdateOriginalDSLOtherMultiAttr:z,handleUpdateDsl:q,handleUpdateMultiExecutionResult:j,displayName:n,childrenNode:f,componentNode:s,triggerEventHandler:V,triggerMappedEventHandler:$})})})})});B.displayName="TransformWidgetWrapper";const I=b=>{const{componentNode:s,unitW:i,displayNamePrefix:n}=b,{x:h,y,w:g,h:f}=pe(s,i,n);return l(de,{bounds:"parent",size:{width:g,height:f},position:{x:h,y},enableResizing:!1,disableDragging:!0,minWidth:ie*i,minHeight:s.minH*L,children:l("div",{className:"wrapperPending",css:ce,children:l(B,{componentNode:s,unitW:i})})})};I.displayName="ScaleSquareWithJSON";const Ce=t.memo(I),Pe=b=>{const{componentNode:s,columnNumber:i=le,displayNamePrefix:n,containerPadding:h}=b,[y,g]=ae(),f=t.useMemo(()=>g.width/i,[i,g.width]),P=t.useMemo(()=>{const o=s.childrenNode;return o==null?void 0:o.map(E=>{switch(E.containerType){case"EDITOR_SCALE_SQUARE":return l(Ce,{componentNode:E,unitW:f,columnNumber:i,displayNamePrefix:n},E.displayName);default:return null}})},[i,s.childrenNode,n,f]);return l("div",{css:me(h),ref:y,"data-list-widget-container":!0,children:P})};export{Pe as R};
//# sourceMappingURL=renderComponentCanvasContainerWithJson-172a9d8b.js.map
