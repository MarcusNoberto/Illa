{"version":3,"file":"rate-ec098ffc.js","sources":["../../src/widgetLibrary/RateWidget/style.ts","../../src/widgetLibrary/RateWidget/rate.tsx"],"sourcesContent":["import { css } from \"@emotion/react\"\n\nexport const rateStyle = css`\n  overflow: hidden;\n`\n","import { FC, useCallback, useEffect, useRef } from \"react\"\nimport { Rate } from \"@illa-design/react\"\nimport { AutoHeightContainer } from \"@/widgetLibrary/PublicSector/AutoHeightContainer\"\nimport { Label } from \"@/widgetLibrary/PublicSector/Label\"\nimport { TooltipWrapper } from \"@/widgetLibrary/PublicSector/TooltipWrapper\"\nimport {\n  applyLabelAndComponentWrapperStyle,\n  applyValidateMessageWrapperStyle,\n} from \"@/widgetLibrary/PublicSector/TransformWidgetWrapper/style\"\nimport { InvalidMessage } from \"../PublicSector/InvalidMessage\"\nimport { handleValidateCheck } from \"../PublicSector/InvalidMessage/utils\"\nimport { RateWidgetProps, WrappedRateProps } from \"./interface\"\nimport { rateStyle } from \"./style\"\n\nexport const WrappedRate: FC<WrappedRateProps> = (props) => {\n  const {\n    value,\n    allowClear,\n    disabled,\n    icon,\n    readonly,\n    allowHalf,\n    maxCount,\n    handleOnChange,\n  } = props\n\n  return (\n    <Rate\n      css={rateStyle}\n      count={maxCount}\n      allowHalf={allowHalf}\n      heart={icon === \"heart\"}\n      disabled={disabled}\n      readonly={readonly}\n      allowClear={allowClear}\n      value={value}\n      onChange={handleOnChange}\n    />\n  )\n}\n\nWrappedRate.displayName = \"WrappedRate\"\n\nexport const RateWidget: FC<RateWidgetProps> = (props) => {\n  const {\n    handleUpdateDsl,\n    updateComponentRuntimeProps,\n    deleteComponentRuntimeProps,\n    labelPosition,\n    labelFull,\n    label,\n    labelAlign,\n    labelWidth = 33,\n    labelCaption,\n    labelWidthUnit,\n    required,\n    labelHidden,\n    tooltipText,\n    hideValidationMessage,\n    validateMessage,\n    customRule,\n    value,\n    updateComponentHeight,\n    triggerEventHandler,\n  } = props\n\n  const triggerRef = useRef<HTMLDivElement>(null)\n  const getValidateMessage = useCallback(\n    (value?: unknown) => {\n      if (!hideValidationMessage) {\n        const message = handleValidateCheck({\n          value,\n          required,\n          customRule,\n        })\n        const showMessage = message && message.length > 0\n        return showMessage ? message : \"\"\n      }\n      return \"\"\n    },\n    [customRule, hideValidationMessage, required],\n  )\n\n  const handleValidate = useCallback(\n    (value?: unknown) => {\n      const message = getValidateMessage(value)\n      handleUpdateDsl({\n        validateMessage: message,\n      })\n      return message\n    },\n    [getValidateMessage, handleUpdateDsl],\n  )\n\n  useEffect(() => {\n    updateComponentRuntimeProps({\n      setValue: (value: number) => {\n        handleUpdateDsl({ value })\n      },\n      clearValue: () => {\n        handleUpdateDsl({ value: 0 })\n      },\n      validate: () => {\n        return handleValidate(value)\n      },\n      clearValidation: () => {\n        handleUpdateDsl({\n          validateMessage: \"\",\n        })\n      },\n    })\n    return () => {\n      deleteComponentRuntimeProps()\n    }\n  }, [\n    updateComponentRuntimeProps,\n    handleUpdateDsl,\n    deleteComponentRuntimeProps,\n    handleValidate,\n    value,\n  ])\n\n  const handleOnChange = useCallback(\n    (value?: string) => {\n      new Promise((resolve) => {\n        const validateMessage = getValidateMessage(value)\n        handleUpdateDsl({ value, validateMessage })\n        resolve(true)\n      }).then(() => {\n        triggerEventHandler(\"change\")\n      })\n    },\n    [getValidateMessage, handleUpdateDsl, triggerEventHandler],\n  )\n\n  return (\n    <AutoHeightContainer updateComponentHeight={updateComponentHeight}>\n      <TooltipWrapper tooltipText={tooltipText} tooltipDisabled={!tooltipText}>\n        <div\n          css={applyLabelAndComponentWrapperStyle(labelPosition)}\n          ref={triggerRef}\n        >\n          <Label\n            labelFull={labelFull}\n            label={label}\n            labelAlign={labelAlign}\n            labelWidth={labelWidth}\n            labelCaption={labelCaption}\n            labelWidthUnit={labelWidthUnit}\n            labelPosition={labelPosition}\n            required={required}\n            labelHidden={labelHidden}\n            hasTooltip={!!tooltipText}\n          />\n          <WrappedRate {...props} handleOnChange={handleOnChange} />\n        </div>\n      </TooltipWrapper>\n      {!hideValidationMessage && (\n        <div\n          css={applyValidateMessageWrapperStyle(\n            labelWidth,\n            labelPosition,\n            labelHidden || !label,\n          )}\n        >\n          <InvalidMessage validateMessage={validateMessage} />\n        </div>\n      )}\n    </AutoHeightContainer>\n  )\n}\nRateWidget.displayName = \"RateWidget\"\nexport default RateWidget\n"],"names":["rateStyle","css","WrappedRate","props","value","allowClear","disabled","icon","readonly","allowHalf","maxCount","handleOnChange","jsx","Rate","RateWidget","handleUpdateDsl","updateComponentRuntimeProps","deleteComponentRuntimeProps","labelPosition","labelFull","label","labelAlign","labelWidth","labelCaption","labelWidthUnit","required","labelHidden","tooltipText","hideValidationMessage","validateMessage","customRule","updateComponentHeight","triggerEventHandler","triggerRef","useRef","getValidateMessage","useCallback","message","handleValidateCheck","handleValidate","useEffect","resolve","jsxs","AutoHeightContainer","TooltipWrapper","applyLabelAndComponentWrapperStyle","Label","applyValidateMessageWrapperStyle","InvalidMessage"],"mappings":"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"}