{"version":3,"file":"dateTime-d4628b7b.js","sources":["../../src/widgetLibrary/DateTimeWidget/dateTime.tsx"],"sourcesContent":["import dayjs, { Dayjs } from \"dayjs\"\nimport { FC, useCallback, useEffect } from \"react\"\nimport { SingleDatePicker } from \"@illa-design/react\"\nimport { AutoHeightContainer } from \"@/widgetLibrary/PublicSector/AutoHeightContainer\"\nimport { InvalidMessage } from \"@/widgetLibrary/PublicSector/InvalidMessage\"\nimport { handleValidateCheck } from \"@/widgetLibrary/PublicSector/InvalidMessage/utils\"\nimport { Label } from \"@/widgetLibrary/PublicSector/Label\"\nimport { TooltipWrapper } from \"@/widgetLibrary/PublicSector/TooltipWrapper\"\nimport {\n  applyLabelAndComponentWrapperStyle,\n  applyValidateMessageWrapperStyle,\n} from \"@/widgetLibrary/PublicSector/TransformWidgetWrapper/style\"\nimport { DateTimeWidgetProps, WrappedDateTimeProps } from \"./interface\"\n\nexport const WrappedDateTime: FC<WrappedDateTimeProps> = (props) => {\n  const {\n    value,\n    format,\n    placeholder,\n    showClear,\n    minDate,\n    disabled,\n    maxDate,\n    minuteStep,\n    colorScheme,\n    handleOnChange,\n    getValidateMessage,\n    handleUpdateMultiExecutionResult,\n    displayName,\n    readOnly,\n  } = props\n\n  const changeValue = (value?: unknown) => {\n    new Promise((resolve) => {\n      const message = getValidateMessage(value)\n      handleUpdateMultiExecutionResult([\n        {\n          displayName,\n          value: {\n            value: value || \"\",\n            validateMessage: message,\n          },\n        },\n      ])\n      resolve(true)\n    }).then(() => {\n      handleOnChange?.()\n    })\n  }\n\n  const checkRange = useCallback(\n    (current?: Dayjs) => {\n      const beforeMinDate = minDate\n        ? !!current?.isBefore(dayjs(minDate))\n        : false\n      const afterMaxDate = maxDate ? !!current?.isAfter(dayjs(maxDate)) : false\n      return beforeMinDate || afterMaxDate\n    },\n    [minDate, maxDate],\n  )\n\n  return (\n    <SingleDatePicker\n      w=\"100%\"\n      showTime={{ step: { minute: minuteStep }, format }}\n      colorScheme={colorScheme}\n      format={format}\n      value={value}\n      disabled={disabled}\n      placeholder={placeholder}\n      allowClear={showClear}\n      disabledDate={checkRange}\n      onClear={() => {\n        changeValue(\"\")\n      }}\n      onChange={changeValue}\n      editable={!readOnly}\n    />\n  )\n}\n\nWrappedDateTime.displayName = \"WrappedDateTime\"\n\nexport const DateTimeWidget: FC<DateTimeWidgetProps> = (props) => {\n  const {\n    value,\n    updateComponentRuntimeProps,\n    deleteComponentRuntimeProps,\n    handleUpdateDsl,\n    labelPosition,\n    labelFull,\n    label,\n    labelAlign,\n    labelWidth = 33,\n    labelCaption,\n    labelWidthUnit,\n    required,\n    labelHidden,\n    tooltipText,\n    pattern,\n    regex,\n    customRule,\n    hideValidationMessage,\n    updateComponentHeight,\n    validateMessage,\n    triggerEventHandler,\n  } = props\n\n  const getValidateMessage = useCallback(\n    (value?: unknown) => {\n      if (!hideValidationMessage) {\n        const message = handleValidateCheck({\n          value,\n          required,\n          customRule,\n          pattern,\n          regex,\n        })\n        const showMessage = message && message.length > 0\n        return showMessage ? message : \"\"\n      }\n      return \"\"\n    },\n    [customRule, hideValidationMessage, pattern, regex, required],\n  )\n\n  const handleValidate = useCallback(\n    (value?: unknown) => {\n      const message = getValidateMessage(value)\n      handleUpdateDsl({\n        validateMessage: message,\n      })\n      return message\n    },\n    [getValidateMessage, handleUpdateDsl],\n  )\n\n  useEffect(() => {\n    updateComponentRuntimeProps({\n      setValue: (value: string) => {\n        handleUpdateDsl({ value })\n      },\n      clearValue: () => {\n        handleUpdateDsl({ value: \"\" })\n      },\n      validate: () => {\n        return handleValidate(value)\n      },\n    })\n    return () => {\n      deleteComponentRuntimeProps()\n    }\n  }, [\n    deleteComponentRuntimeProps,\n    handleUpdateDsl,\n    handleValidate,\n    updateComponentRuntimeProps,\n    value,\n  ])\n\n  const handleOnChange = useCallback(() => {\n    triggerEventHandler(\"change\")\n  }, [triggerEventHandler])\n\n  return (\n    <AutoHeightContainer updateComponentHeight={updateComponentHeight}>\n      <TooltipWrapper tooltipText={tooltipText} tooltipDisabled={!tooltipText}>\n        <div css={applyLabelAndComponentWrapperStyle(labelPosition)}>\n          <Label\n            labelFull={labelFull}\n            label={label}\n            labelAlign={labelAlign}\n            labelWidth={labelWidth}\n            labelCaption={labelCaption}\n            labelWidthUnit={labelWidthUnit}\n            labelPosition={labelPosition}\n            required={required}\n            labelHidden={labelHidden}\n            hasTooltip={!!tooltipText}\n          />\n          <WrappedDateTime\n            {...props}\n            getValidateMessage={getValidateMessage}\n            handleOnChange={handleOnChange}\n          />\n        </div>\n      </TooltipWrapper>\n      {!hideValidationMessage && (\n        <div\n          css={applyValidateMessageWrapperStyle(\n            labelWidth,\n            labelPosition,\n            labelHidden || !label,\n          )}\n        >\n          <InvalidMessage validateMessage={validateMessage} />\n        </div>\n      )}\n    </AutoHeightContainer>\n  )\n}\n\nDateTimeWidget.displayName = \"DateTimeWidget\"\nexport default DateTimeWidget\n"],"names":["WrappedDateTime","props","value","format","placeholder","showClear","minDate","disabled","maxDate","minuteStep","colorScheme","handleOnChange","getValidateMessage","handleUpdateMultiExecutionResult","displayName","readOnly","changeValue","resolve","message","checkRange","useCallback","current","beforeMinDate","dayjs","afterMaxDate","jsx","SingleDatePicker","DateTimeWidget","updateComponentRuntimeProps","deleteComponentRuntimeProps","handleUpdateDsl","labelPosition","labelFull","label","labelAlign","labelWidth","labelCaption","labelWidthUnit","required","labelHidden","tooltipText","pattern","regex","customRule","hideValidationMessage","updateComponentHeight","validateMessage","triggerEventHandler","handleValidateCheck","handleValidate","useEffect","jsxs","AutoHeightContainer","TooltipWrapper","applyLabelAndComponentWrapperStyle","Label","applyValidateMessageWrapperStyle","InvalidMessage"],"mappings":"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"}