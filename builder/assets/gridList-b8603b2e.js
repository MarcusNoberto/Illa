import{k as a,b7 as ce,o as ee,bX as He,n as we,av as _e,bq as je,A as Ue,F as Ve}from"./@illa-design-402f214a.js";import{dl as re,eG as ie,eM as Re,b as ue,b4 as Me,e as ze,eN as ke,bf as ye,eO as Fe,eP as De,eQ as Ee,eR as ve,eS as Se,ez as $e,eT as xe,eU as Je,eV as Xe,cj as Ye,ci as qe,cm as Qe,dg as Ke,dh as Ze,di as et,aS as Ae,eI as tt,eJ as nt,eK as Ce}from"./index-2f1869ab.js";import{r as s}from"./react-9b7e00e3.js";import{R as Te}from"./index-f466602f.js";import{g as Oe}from"./style-7ce959a8.js";import{R as at}from"./renderComponentCanvasContainerWithJson-bd5b0f08.js";import{R as it}from"./index-c428eaa3.js";import{G as st,i as Le,t as ot,g as Ne,s as le}from"./lodash-lib-6e94956b.js";import{a as Pe}from"./@emotion-4f16718e.js";import"./codeMirror-vendor-eff8ab8d.js";import"./react-icons-vendor-2430ea65.js";import"./index-e7294a86.js";import"./clsx.m-925abe8b.js";import"./clsx.m-266f4de0.js";import"./renderComponentCanvasContainer-44ad78fe.js";import"./index-cf2bb556.js";import"./index-b8442d1a.js";const Be=i=>{const{templateComponentNodes:e,templateContainerHeight:n,columnNumber:f,displayNamePrefix:t}=i;return e?a(at,{componentNode:e,containerPadding:0,columnNumber:f,displayNamePrefix:t}):null},Ge=i=>{const{templateComponentDisplayName:e,columnNumber:n,itemGap:f=ie,dynamicHeight:t,extraHeight:A=0,templateContainerHeight:F,handleUpdateOriginalDSLMultiAttr:o,updateComponentHeight:E,itemNumber:I=1,enableAutoPagination:J,itemShadow:$,itemPadding:x}=i,H=t!=="fixed",T=s.useCallback(g=>{if(!E)return;g+2*re!==F&&o({itemHeight:g+2*re},!0);let h,G=f>=0?f:ie;J?h=g+A+ie+2*re+(g+2*re+G)*(I-1)+Re($)*2:h=g+2*re+(g+2*re+G)*(I-1)+Re($)*2,E(h)},[o,I,F,E,A,J,f,$]);return a(it,{displayName:e,columnNumber:n,handleUpdateHeight:T,canResizeCanvas:H,containerPadding:x==null?void 0:x.size})},rt=i=>{const{dataSources:e,itemHeight:n=48,displayName:f,page:t=0,dynamicMinHeight:A,dynamicMaxHeight:F,enablePagination:o,childrenNode:E,itemGapX:I=ie,itemGapY:J=ie,itemShadow:$,itemBorderColor:x,itemBorderRadius:H,itemBorderWidth:T,columnNumAdaptation:g,numberOfColumns:h=3,minColumnWidth:G,handleUpdateOriginalDSLMultiAttr:w,updateComponentHeight:M,copyComponents:Q,pageSize:X,handleUpdateSelectedItem:Y,itemBackGroundColor:te,columnNumber:d,dynamicHeight:z="fixed",selectIndexForMark:r,themeColor:m,loading:N,handleUpdateMultiExecutionResult:K,itemPadding:p,h:S}=i,[ne,P]=ce(),[q,k]=ce(),[W,u]=ce(),[C,R]=s.useState(!1),D=ue(Me),_=ze(),b=X||0,y=P.height-k.height,j=s.useMemo(()=>o?b:e==null?void 0:e.length,[e==null?void 0:e.length,o,b]),he=s.useCallback(l=>{Y(),K([{displayName:f,value:{page:l-1}}])},[f,K,Y]),U=s.useMemo(()=>{const l=st(Q,j);return l.length===0?[]:t<l.length?l[t]:l[0]},[Q,t,j]),be=s.useMemo(()=>g===ke.FIXED&&h?Math.ceil(U.length/h):Math.ceil(U.length/(P.width/u.width)),[g,P.width,U.length,u.width,h]),ae=l=>{l.preventDefault(),l.stopPropagation(),_(ye.setResizingNodeIDsReducer([`${f}-resize-grid`]))},de=s.useCallback((l,O,L,V)=>{const{height:se}=V;let oe=n+se;w({itemHeight:oe}),_(ye.setResizingNodeIDsReducer([]))},[_,w,n]),me=D&&C,ge=Oe($),pe=s.useMemo(()=>{let l,O;const L=T==null?void 0:T.match(/\d+(\.\d+)?/g);L&&(l=(L==null?void 0:L.join(""))+"px");const V=H==null?void 0:H.match(/\d+(\.\d+)?/g);return V&&(O=(V==null?void 0:V.join(""))+"px"),`
    border: ${l?`${l} solid ${x}`:"unset"};
      border-radius: ${O??"unset"}
    `},[x,H,T]);return ee("div",{css:Fe,onMouseEnter:()=>{R(!0)},onMouseLeave:()=>{R(!1)},ref:ne,children:[ee("div",{css:De(g,I,J,$,h,G),children:[(t==null||t===0)&&ee(Te,{size:{width:"100%",height:n},bounds:"parent",minHeight:48,maxHeight:z!=="fixed"?"unset":y-4,handleComponent:C?Ee():void 0,enable:z!=="fixed"||N?{}:{bottom:!0},onResizeStart:ae,onResizeStop:de,children:[a("div",{css:ve(r===0,D,m,H),children:a("div",{css:Se(!0,te,ge,pe,D,N),ref:W,onClick:l=>{var L;const O=!!((L=l.target)!=null&&L.getAttribute("data-list-widget-container"));Y(0,O)},children:a(Ge,{templateComponentDisplayName:E[0],templateContainerHeight:n,columnNumber:d,dynamicHeight:z,itemNumber:be,extraHeight:k.height,itemShadow:$,enableAutoPagination:o,handleUpdateOriginalDSLMultiAttr:w,h:S,updateComponentHeight:M,dynamicMinHeight:A,dynamicMaxHeight:F,itemGap:J,itemPadding:p})})}),me&&a("div",{css:$e(!1,!0,!1)})]},E[0]),U.map((l,O)=>{if((t==null||t===0)&&O===0)return null;const L=t??0;return a("div",{css:ve(r===O,D,m,H,n),children:a("div",{css:Se(!1,te,ge,pe,D,N,n,p==null?void 0:p.size),onClick:V=>{var oe;const se=!!((oe=V.target)!=null&&oe.getAttribute("data-list-widget-container"));Y(O,se)},children:a(Be,{templateComponentNodes:l,templateContainerHeight:n,columnNumber:d,displayNamePrefix:`grid-list-child-${L*j+O}-`})})},l.displayName)})]}),o&&a("div",{css:xe,ref:q,children:a(He,{total:e==null?void 0:e.length,current:t+1,pageSize:j,disableSimplePageJump:!0,size:"medium",sizeCanChange:!1,hideOnSinglePage:!1,simple:!0,onChange:he})})]})},lt=Pe`
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
`,Ie=i=>Pe`
    pointer-events: ${i?"not-allowed":"auto"};
    font-size: 14px;
    width: 32px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 32px;
    border-radius: 4px;
    cursor: ${i?"not-allowed":"pointer"};
    color: ${we("grayBlue",i?"08":"03")};
    background-color: unset;
  `,ct=({hasNextPage:i,page:e,onChange:n})=>ee("div",{css:lt,children:[a("span",{css:Ie(e<=0),onClick:()=>n(!1),children:a(_e,{size:"14px"})}),e+1,a("span",{css:Ie(!i),onClick:()=>i&&n(!0),children:a(je,{size:"14px"})})]}),dt=i=>{const{itemHeight:e=48,handleUpdateOriginalDSLMultiAttr:n,childrenNode:f,copyComponents:t=[],handleUpdateSelectedItem:A,itemBackGroundColor:F,columnNumber:o,pageSize:E,paginationType:I,totalRowCount:J,nextCursor:$,previousCursor:x,itemGapX:H=ie,itemGapY:T=ie,itemBorderColor:g,itemBorderRadius:h,itemBorderWidth:G,itemShadow:w,page:M=1,enableServerSidePagination:Q,dynamicHeight:X,updateComponentHeight:Y,h:te,dynamicMinHeight:d,dynamicMaxHeight:z,displayName:r,columnNumAdaptation:m,numberOfColumns:N=3,minColumnWidth:K,disabled:p,selectIndexForMark:S,themeColor:ne,handleUpdateMultiExecutionResult:P,triggerEventHandler:q,enablePagination:k,loading:W,itemPadding:u}=i,[C,R]=ce(),[D,_]=ce(),[b,y]=ce(),[j,he]=s.useState(!1),U=E||0,be=R.height-_.height,ae=ue(Me),de=ze(),me=s.useRef(i),ge=s.useCallback(c=>{c<=0||p||(A(),new Promise(v=>{P([{displayName:r,value:{page:c-1}}]),v(!0)}).then(()=>{q("pageChange")}))},[p,A,P,r,q]),pe=s.useCallback(c=>{if(M<=0&&!c||p)return;A();let v;c?v={page:M+1,beforeCursor:void 0,afterCursor:$}:v={page:M-1,beforeCursor:x,afterCursor:void 0},new Promise(B=>{P([{displayName:r,value:v}]),B(!0)}).then(()=>{q("pageChange")})},[p,r,P,A,$,M,x,q]);s.useEffect(()=>{Le(me.current,i)||(me.current=i)},[i]);const l=c=>{c.preventDefault(),c.stopPropagation(),de(ye.setResizingNodeIDsReducer([`${r}-resize-list-item`]))},O=s.useCallback((c,v,B,Z)=>{let fe=e+Z.height;n({itemHeight:fe}),de(ye.setResizingNodeIDsReducer([]))},[de,n,e]),L=ae&&j,V=Oe(w),se=s.useMemo(()=>{let c,v;const B=G==null?void 0:G.match(/\d+(\.\d+)?/g);B&&(c=(B==null?void 0:B.join(""))+"px");const Z=h==null?void 0:h.match(/\d+(\.\d+)?/g);return Z&&(v=(Z==null?void 0:Z.join(""))+"px"),`
    border: ${c?`${c} solid ${g}`:"unset"};
      border-radius: ${v??"unset"}
    `},[g,h,G]),oe=s.useMemo(()=>{const c=U>((t==null?void 0:t.length)??0)?(t==null?void 0:t.length)??0:U;return m===ke.FIXED&&N?Math.ceil(c/N):Math.ceil(c/(R.width/y.width))},[m,R.width,y.width,N,U,t==null?void 0:t.length]);return s.useEffect(()=>{P([{displayName:r,value:{offset:U*M}}])},[r,P,M,U]),ee("div",{css:Je,ref:C,onMouseEnter:()=>{he(!0)},onMouseLeave:()=>{he(!1)},children:[ee("div",{css:De(m,H,T,w,N,K),children:[ee(Te,{size:{width:"100%",height:e},bounds:"parent",minHeight:48,maxHeight:X!=="fixed"?"unset":be-4,handleComponent:j?Ee():void 0,enable:X!=="fixed"||W?{}:{bottom:!0},onResizeStart:l,onResizeStop:O,children:[a("div",{css:ve(S===0,ae,ne,h),children:a("div",{css:Se(!0,F,V,se,ae,W),onClick:c=>{var B;const v=!!((B=c.target)!=null&&B.getAttribute("data-list-widget-container"));A(0,v)},children:a(Ge,{templateComponentDisplayName:f[0],templateContainerHeight:e,columnNumber:o,dynamicHeight:X,extraHeight:_.height,itemShadow:w,enableAutoPagination:k,handleUpdateOriginalDSLMultiAttr:n,itemNumber:oe,updateComponentHeight:Y,h:te,dynamicMinHeight:d,dynamicMaxHeight:z,itemGap:T,itemPadding:u})})}),L&&a("div",{css:$e(!1,!0,!1)})]}),t==null?void 0:t.map((c,v)=>v===0?null:a("div",{css:ve(S===v,ae,ne,h,e),children:a("div",{css:Se(!1,F,V,se,ae,W,e,u==null?void 0:u.size),ref:b,onClick:B=>{var fe;const Z=!!((fe=B.target)!=null&&fe.getAttribute("data-list-widget-container"));A(v,Z)},children:a(Be,{templateComponentNodes:c,templateContainerHeight:e,columnNumber:o,displayNamePrefix:`grid-list-child-${v}-`})})},c.displayName))]}),k&&Q&&a("div",{css:xe,ref:D,children:I===Xe.LIMIT_OFFSET_BASED?a(He,{total:J??1,current:M+1,pageSize:U,size:"medium",disableSimplePageJump:!0,sizeCanChange:!1,hideOnSinglePage:!1,simple:!0,onChange:ge}):a(ct,{page:M,hasNextPage:i.hasNextPage,onChange:pe})})]})},ut=Pe`
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  background-color: ${we("white","03")};
`,We=({themeColor:i})=>a("div",{css:ut,children:a(Ue,{colorScheme:i})});We.displayName="ComponentLoading";const Mt=i=>{const{displayName:e,dataSources:n,childrenNode:f,enableServerSidePagination:t,paginationType:A,enablePagination:F,handleUpdateMultiExecutionResult:o,triggerEventHandler:E,disabled:I,loading:J,themeColor:$,page:x=1,pageSize:H=10}=i,T=ue(Ye),g=ue(qe),h=ue(Qe),G=s.useRef(n),[w,M]=s.useState(),Q=s.useCallback(d=>d.map((z,r)=>{const m=Ke(h[z]),N=m.childrenNode;if(Array.isArray(N)&&N.length>0){let K=N.map(p=>{const S=JSON.parse(JSON.stringify(h[p]));if(S.props&&Array.isArray(S.props.$dynamicAttrPaths)){const{displayName:ne}=S,{$dynamicAttrPaths:P}=S.props;P.forEach(q=>{const k=Ze(ot(q)),W=Ne(S.props,k,"");let u;try{u=et("",W,T)}catch(R){console.log(R),u=""}let C=u;if(Array.isArray(u)&&u.length>r){const R=g[ne];if(R&&Ae(R.$validationPaths)){const D=R.$validationPaths,_=Ne(D,k);if(_===tt.ARRAY)if(Array.isArray(u)){const b=u[r]??[],y=Ce[_],j=y==null?void 0:y(b,"");C=(j==null?void 0:j.safeValue)??b}else{const b=Ce[_],y=b==null?void 0:b(u,"");C=(y==null?void 0:y.safeValue)??u}else{C=u[r];const b=Ce[_],y=b==null?void 0:b(C,"");C=(y==null?void 0:y.safeValue)??C}}}le(S,`props.${k}`,C)})}return r!==0&&(le(S,"displayName",`grid-list-child-${r}-${p}`),I!=null&&le(S,"props.disabled",I)),S});K=K.map(p=>{const P=p.displayName.split("-").at(-1),k=g[P].$validationPaths;return Ae(k)&&nt(k).forEach(W=>{const u=k[W],C=Ce[u],R=Ne(p,`props.${W}`,""),D=C==null?void 0:C(R,"");le(p,`props.${W}`,D==null?void 0:D.safeValue)}),p}),le(m,"childrenNode",K)}return r!==0&&le(m,"displayName",`grid-list-widget-container-${r}`),m}),[h,I,T,g]),X=s.useCallback(d=>{const z=[];return Array.isArray(n)&&n.length>0?(n.forEach((r,m)=>{z[m]=d}),Q(z)):Q([d])},[n,Q]),Y=s.useMemo(()=>{if(f&&f.length>0&&n){let d=f[0];return X(d)}return null},[f,n,X]),te=s.useCallback((d,z)=>{!Array.isArray(n)||I||(M(w===d&&z||d===void 0?void 0:d),new Promise(r=>{let m;if(d===void 0||w===d&&z)m={selectedItem:void 0,selectedIndex:void 0};else{const N=t?d:d+x*(H??0);m={selectedItem:n[N],selectedIndex:d}}o([{displayName:e,value:m}]),r(m)}).then(()=>{E("clickItem")}))},[n,I,e,t,o,x,H,w,E]);return s.useEffect(()=>{Le(G.current,n)||o==null||o([{displayName:e,value:{selectedIndex:void 0,selectedItem:void 0}}])},[n,e,o]),s.useEffect(()=>{o==null||o([{displayName:e,value:{page:0}}])},[e,o,A,F,t]),ee(Ve,{children:[t?a(dt,{...i,copyComponents:Y,handleUpdateSelectedItem:te,selectIndexForMark:w}):a(rt,{...i,copyComponents:Y,handleUpdateSelectedItem:te,selectIndexForMark:w}),J&&a(We,{themeColor:$})]})};export{Mt as GridListWidget,Mt as default};
//# sourceMappingURL=gridList-b8603b2e.js.map
